<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Scenario III: large effect, uniform prior | Validation Report for adoptr package</title>
  <meta name="description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Scenario III: large effect, uniform prior | Validation Report for adoptr package" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  <meta name="github-repo" content="kkmann/adoptr-validation-report" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Scenario III: large effect, uniform prior | Validation Report for adoptr package" />
  
  <meta name="twitter:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  

<meta name="author" content="Kevin Kunzmann &amp; Maximilian Pilz" />


<meta name="date" content="2019-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scenarioII.html">
<link rel="next" href="scenarioIV.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Validation Report for adoptr Package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#concept"><i class="fa fa-check"></i><b>1.1</b> Concept</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#validation-scenarios"><i class="fa fa-check"></i><b>1.2</b> Validation Scenarios</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#scenario-i-large-effect-point-prior"><i class="fa fa-check"></i><b>1.2.1</b> <a href="scenarioI.html#scenarioI">Scenario I: Large effect, point prior</a></a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#scenario-ii-large-effect-gaussian-prior"><i class="fa fa-check"></i><b>1.2.2</b> <a href="scenarioII.html#scenarioII">Scenario II: Large effect, Gaussian prior</a></a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#scenario-iii-large-effect-uniform-prior"><i class="fa fa-check"></i><b>1.2.3</b> <a href="scenarioIII.html#scenarioIII">Scenario III: Large effect, uniform prior</a></a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#scenario-iv-smaller-effect-size-larger-trials"><i class="fa fa-check"></i><b>1.2.4</b> <a href="scenarioIV.html#scenarioIV">Scenario IV: Smaller effect size, larger trials</a></a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#scenario-v-single-arm-design-medium-effect-size"><i class="fa fa-check"></i><b>1.2.5</b> <a href="scenarioV.html#scenarioV">Scenario V: Single-arm design, medium effect size</a></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#technical-setup"><i class="fa fa-check"></i><b>1.3</b> Technical Setup</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="scenarioI.html"><a href="scenarioI.html"><i class="fa fa-check"></i><b>2</b> Scenario I: large effect, point prior</a><ul>
<li class="chapter" data-level="2.1" data-path="scenarioI.html"><a href="scenarioI.html#details"><i class="fa fa-check"></i><b>2.1</b> Details</a></li>
<li class="chapter" data-level="2.2" data-path="scenarioI.html"><a href="scenarioI.html#variantI_1"><i class="fa fa-check"></i><b>2.2</b> Variant I-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="2.2.1" data-path="scenarioI.html"><a href="scenarioI.html#objective"><i class="fa fa-check"></i><b>2.2.1</b> Objective</a></li>
<li class="chapter" data-level="2.2.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains"><i class="fa fa-check"></i><b>2.2.2</b> Constrains</a></li>
<li class="chapter" data-level="2.2.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-designs"><i class="fa fa-check"></i><b>2.2.3</b> Initial Designs</a></li>
<li class="chapter" data-level="2.2.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization"><i class="fa fa-check"></i><b>2.2.4</b> Optimization</a></li>
<li class="chapter" data-level="2.2.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases"><i class="fa fa-check"></i><b>2.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="scenarioI.html"><a href="scenarioI.html#variantI_2"><i class="fa fa-check"></i><b>2.3</b> Variant I-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-1"><i class="fa fa-check"></i><b>2.3.1</b> Objective</a></li>
<li class="chapter" data-level="2.3.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains-1"><i class="fa fa-check"></i><b>2.3.2</b> Constrains</a></li>
<li class="chapter" data-level="2.3.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design"><i class="fa fa-check"></i><b>2.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.3.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-1"><i class="fa fa-check"></i><b>2.3.4</b> Optimization</a></li>
<li class="chapter" data-level="2.3.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-1"><i class="fa fa-check"></i><b>2.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="scenarioI.html"><a href="scenarioI.html#variantI_3"><i class="fa fa-check"></i><b>2.4</b> Variant I-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="2.4.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-2"><i class="fa fa-check"></i><b>2.4.1</b> Objective</a></li>
<li class="chapter" data-level="2.4.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains-2"><i class="fa fa-check"></i><b>2.4.2</b> Constrains</a></li>
<li class="chapter" data-level="2.4.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design-1"><i class="fa fa-check"></i><b>2.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.4.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-2"><i class="fa fa-check"></i><b>2.4.4</b> Optimization</a></li>
<li class="chapter" data-level="2.4.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-2"><i class="fa fa-check"></i><b>2.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="scenarioI.html"><a href="scenarioI.html#plot-two-stage-designs"><i class="fa fa-check"></i><b>2.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scenarioII.html"><a href="scenarioII.html"><i class="fa fa-check"></i><b>3</b> Scenario II: Large effect, Gaussian prior</a><ul>
<li class="chapter" data-level="3.1" data-path="scenarioII.html"><a href="scenarioII.html#details-1"><i class="fa fa-check"></i><b>3.1</b> Details</a></li>
<li class="chapter" data-level="3.2" data-path="scenarioII.html"><a href="scenarioII.html#variantII_1"><i class="fa fa-check"></i><b>3.2</b> Variant II-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-3"><i class="fa fa-check"></i><b>3.2.1</b> Objective</a></li>
<li class="chapter" data-level="3.2.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-3"><i class="fa fa-check"></i><b>3.2.2</b> Constrains</a></li>
<li class="chapter" data-level="3.2.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-2"><i class="fa fa-check"></i><b>3.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.2.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-3"><i class="fa fa-check"></i><b>3.2.4</b> Optimization</a></li>
<li class="chapter" data-level="3.2.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-3"><i class="fa fa-check"></i><b>3.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scenarioII.html"><a href="scenarioII.html#variantII_2"><i class="fa fa-check"></i><b>3.3</b> Variant II-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-4"><i class="fa fa-check"></i><b>3.3.1</b> Objective</a></li>
<li class="chapter" data-level="3.3.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-4"><i class="fa fa-check"></i><b>3.3.2</b> Constrains</a></li>
<li class="chapter" data-level="3.3.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-3"><i class="fa fa-check"></i><b>3.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.3.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-4"><i class="fa fa-check"></i><b>3.3.4</b> Optimization</a></li>
<li class="chapter" data-level="3.3.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-4"><i class="fa fa-check"></i><b>3.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="scenarioII.html"><a href="scenarioII.html#variantII_3"><i class="fa fa-check"></i><b>3.4</b> Variant II-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="3.4.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-5"><i class="fa fa-check"></i><b>3.4.1</b> Objective</a></li>
<li class="chapter" data-level="3.4.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-5"><i class="fa fa-check"></i><b>3.4.2</b> Constrains</a></li>
<li class="chapter" data-level="3.4.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-4"><i class="fa fa-check"></i><b>3.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.4.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-5"><i class="fa fa-check"></i><b>3.4.4</b> Optimization</a></li>
<li class="chapter" data-level="3.4.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-5"><i class="fa fa-check"></i><b>3.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scenarioII.html"><a href="scenarioII.html#plot-two-stage-designs-1"><i class="fa fa-check"></i><b>3.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scenarioIII.html"><a href="scenarioIII.html"><i class="fa fa-check"></i><b>4</b> Scenario III: large effect, uniform prior</a><ul>
<li class="chapter" data-level="4.1" data-path="scenarioIII.html"><a href="scenarioIII.html#details-2"><i class="fa fa-check"></i><b>4.1</b> Details</a></li>
<li class="chapter" data-level="4.2" data-path="scenarioIII.html"><a href="scenarioIII.html#variantIII_1"><i class="fa fa-check"></i><b>4.2</b> Variant III.1: Convergence under prior concentration</a><ul>
<li class="chapter" data-level="4.2.1" data-path="scenarioIII.html"><a href="scenarioIII.html#objective-6"><i class="fa fa-check"></i><b>4.2.1</b> Objective</a></li>
<li class="chapter" data-level="4.2.2" data-path="scenarioIII.html"><a href="scenarioIII.html#constrains-6"><i class="fa fa-check"></i><b>4.2.2</b> Constrains</a></li>
<li class="chapter" data-level="4.2.3" data-path="scenarioIII.html"><a href="scenarioIII.html#optimization-problem"><i class="fa fa-check"></i><b>4.2.3</b> Optimization problem</a></li>
<li class="chapter" data-level="4.2.4" data-path="scenarioIII.html"><a href="scenarioIII.html#test-cases-6"><i class="fa fa-check"></i><b>4.2.4</b> Test cases</a></li>
<li class="chapter" data-level="4.2.5" data-path="scenarioIII.html"><a href="scenarioIII.html#plot-designs"><i class="fa fa-check"></i><b>4.2.5</b> Plot designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scenarioIV.html"><a href="scenarioIV.html"><i class="fa fa-check"></i><b>5</b> Scenario IV: smaller effect, point prior</a><ul>
<li class="chapter" data-level="5.1" data-path="scenarioIV.html"><a href="scenarioIV.html#details-3"><i class="fa fa-check"></i><b>5.1</b> Details</a></li>
<li class="chapter" data-level="5.2" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_1"><i class="fa fa-check"></i><b>5.2</b> Variant IV-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="5.2.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-7"><i class="fa fa-check"></i><b>5.2.1</b> Objective</a></li>
<li class="chapter" data-level="5.2.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-7"><i class="fa fa-check"></i><b>5.2.2</b> Constrains</a></li>
<li class="chapter" data-level="5.2.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-5"><i class="fa fa-check"></i><b>5.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.2.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-6"><i class="fa fa-check"></i><b>5.2.4</b> Optimization</a></li>
<li class="chapter" data-level="5.2.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-7"><i class="fa fa-check"></i><b>5.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_2"><i class="fa fa-check"></i><b>5.3</b> Variant IV-2: Increase Power</a><ul>
<li class="chapter" data-level="5.3.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-8"><i class="fa fa-check"></i><b>5.3.1</b> Objective</a></li>
<li class="chapter" data-level="5.3.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-8"><i class="fa fa-check"></i><b>5.3.2</b> Constrains</a></li>
<li class="chapter" data-level="5.3.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-6"><i class="fa fa-check"></i><b>5.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.3.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-7"><i class="fa fa-check"></i><b>5.3.4</b> Optimization</a></li>
<li class="chapter" data-level="5.3.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-8"><i class="fa fa-check"></i><b>5.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_3"><i class="fa fa-check"></i><b>5.4</b> Variant IV-3: Increase Type One Error rate</a><ul>
<li class="chapter" data-level="5.4.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-9"><i class="fa fa-check"></i><b>5.4.1</b> Objective</a></li>
<li class="chapter" data-level="5.4.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-9"><i class="fa fa-check"></i><b>5.4.2</b> Constrains</a></li>
<li class="chapter" data-level="5.4.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-7"><i class="fa fa-check"></i><b>5.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.4.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-8"><i class="fa fa-check"></i><b>5.4.4</b> Optimization</a></li>
<li class="chapter" data-level="5.4.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-9"><i class="fa fa-check"></i><b>5.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="scenarioIV.html"><a href="scenarioIV.html#plot-two-stage-designs-2"><i class="fa fa-check"></i><b>5.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scenarioV.html"><a href="scenarioV.html"><i class="fa fa-check"></i><b>6</b> Scenario V: Single-arm design, medium effect size</a><ul>
<li class="chapter" data-level="6.1" data-path="scenarioV.html"><a href="scenarioV.html#details-4"><i class="fa fa-check"></i><b>6.1</b> Details</a></li>
<li class="chapter" data-level="6.2" data-path="scenarioV.html"><a href="scenarioV.html#variantV_1"><i class="fa fa-check"></i><b>6.2</b> Variant V-1, sensitivity to integration order</a><ul>
<li class="chapter" data-level="6.2.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-10"><i class="fa fa-check"></i><b>6.2.1</b> Objective</a></li>
<li class="chapter" data-level="6.2.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-10"><i class="fa fa-check"></i><b>6.2.2</b> Constrains</a></li>
<li class="chapter" data-level="6.2.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-8"><i class="fa fa-check"></i><b>6.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.2.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-9"><i class="fa fa-check"></i><b>6.2.4</b> Optimization</a></li>
<li class="chapter" data-level="6.2.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-10"><i class="fa fa-check"></i><b>6.2.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="scenarioV.html"><a href="scenarioV.html#variantV_2"><i class="fa fa-check"></i><b>6.3</b> Variant V-2, utility maximization</a><ul>
<li class="chapter" data-level="6.3.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-11"><i class="fa fa-check"></i><b>6.3.1</b> Objective</a></li>
<li class="chapter" data-level="6.3.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-11"><i class="fa fa-check"></i><b>6.3.2</b> Constrains</a></li>
<li class="chapter" data-level="6.3.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-9"><i class="fa fa-check"></i><b>6.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.3.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-10"><i class="fa fa-check"></i><b>6.3.4</b> Optimization</a></li>
<li class="chapter" data-level="6.3.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-11"><i class="fa fa-check"></i><b>6.3.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="scenarioV.html"><a href="scenarioV.html#variantV_3"><i class="fa fa-check"></i><b>6.4</b> Variant V-3, n1-penalty</a><ul>
<li class="chapter" data-level="6.4.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-12"><i class="fa fa-check"></i><b>6.4.1</b> Objective</a></li>
<li class="chapter" data-level="6.4.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-12"><i class="fa fa-check"></i><b>6.4.2</b> Constrains</a></li>
<li class="chapter" data-level="6.4.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-10"><i class="fa fa-check"></i><b>6.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.4.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-11"><i class="fa fa-check"></i><b>6.4.4</b> Optimization</a></li>
<li class="chapter" data-level="6.4.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-12"><i class="fa fa-check"></i><b>6.4.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="scenarioV.html"><a href="scenarioV.html#variantV_4"><i class="fa fa-check"></i><b>6.5</b> Variant V-4, n2-penalty</a><ul>
<li class="chapter" data-level="6.5.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-13"><i class="fa fa-check"></i><b>6.5.1</b> Objective</a></li>
<li class="chapter" data-level="6.5.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-13"><i class="fa fa-check"></i><b>6.5.2</b> Constrains</a></li>
<li class="chapter" data-level="6.5.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-11"><i class="fa fa-check"></i><b>6.5.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.5.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-12"><i class="fa fa-check"></i><b>6.5.4</b> Optimization</a></li>
<li class="chapter" data-level="6.5.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-13"><i class="fa fa-check"></i><b>6.5.5</b> Test cases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation Report for <strong>adoptr</strong> package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scenarioIII" class="section level1">
<h1><span class="header-section-number">4</span> Scenario III: large effect, uniform prior</h1>
<div id="details-2" class="section level2">
<h2><span class="header-section-number">4.1</span> Details</h2>
<p>This scenario is a variant of Scenario I.
The purpose is to asses whether placing uniform priors with decreasing
width of support centered at the <span class="math inline">\(\delta=0.4\)</span> leads to a sequence of
optimal designs which converges towards the solution in Case I-1.</p>
<pre class="sourceCode r"><code class="sourceCode r">datadist &lt;-<span class="st"> </span><span class="kw">Normal</span>(<span class="dt">two_armed =</span> <span class="ot">TRUE</span>)</code></pre>
<p>The null hypothesis is no population mean difference, i.e.
<span class="math inline">\(\mathcal{H}_0:\delta \leq 0\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">H_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)</code></pre>
<p>In this scenario we consider a sequence of uniform distributions
<span class="math inline">\(\delta\sim\operatorname{Unif}(0.4 - \Delta_i, 0.4 + \Delta_i)\)</span>
around <span class="math inline">\(0.4\)</span> with <span class="math inline">\(\Delta_i=(3 - i)/10\)</span> for <span class="math inline">\(i=0\ldots 3\)</span>.
I.e., for <span class="math inline">\(\Delta_3=0\)</span> reduces to <code>PointMassPrior</code> on <span class="math inline">\(\delta=0.4\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">prior &lt;-<span class="st"> </span><span class="cf">function</span>(delta) {
    <span class="cf">if</span> (delta <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
        <span class="kw">return</span>(<span class="kw">PointMassPrior</span>(.<span class="dv">4</span>, <span class="fl">1.0</span>))
    a &lt;-<span class="st"> </span><span class="fl">.4</span> <span class="op">-</span><span class="st"> </span>delta; b &lt;-<span class="st"> </span><span class="fl">.4</span> <span class="op">+</span><span class="st"> </span>delta
    <span class="kw">ContinuousPrior</span>(<span class="cf">function</span>(x) <span class="kw">dunif</span>(x, a, b), <span class="dt">support =</span> <span class="kw">c</span>(a, b))
}</code></pre>
<p>Across all variants in this scenario, the one-sided maximal
type one error rate is restricted to</p>
<pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="fl">0.025</span></code></pre>
<p>and the expected power at the point alternative of <span class="math inline">\(\delta=0.4\)</span> must
be at least</p>
<pre class="sourceCode r"><code class="sourceCode r">min_power &lt;-<span class="st"> </span><span class="fl">0.8</span></code></pre>
<p>I.e. throughout this sceanrio, we always use the two
constraints</p>
<pre class="sourceCode r"><code class="sourceCode r">toer_cnstr &lt;-<span class="st"> </span><span class="kw">Power</span>(datadist, H_<span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span>alpha</code></pre>
<p>and</p>
<pre class="sourceCode r"><code class="sourceCode r">ep_cnstr &lt;-<span class="st"> </span><span class="cf">function</span>(delta) {
    prior     &lt;-<span class="st"> </span><span class="kw">prior</span>(delta)
    cnd_prior &lt;-<span class="st"> </span><span class="kw">condition</span>(prior, <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">bounds</span>(prior)[<span class="dv">2</span>]))
    <span class="kw">return</span>( <span class="kw">Power</span>(datadist, cnd_prior) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.8</span> )
}</code></pre>
</div>
<div id="variantIII_1" class="section level2">
<h2><span class="header-section-number">4.2</span> Variant III.1: Convergence under prior concentration</h2>
<p>Make sure that the optimal solution converges as the prior is more and more
concentrated at a point mass.</p>
<div id="objective-6" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Objective</h3>
<p>Expected sample size under the respective prior is minimized, i.e.,
<span class="math inline">\(\boldsymbol{E}\big[n(\mathcal{D})\big]\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">objective &lt;-<span class="st"> </span><span class="cf">function</span>(delta) {
    <span class="kw">ExpectedSampleSize</span>(datadist, <span class="kw">prior</span>(delta))
}</code></pre>
</div>
<div id="constrains-6" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Constrains</h3>
<p>The constraints have already been described under details.</p>
</div>
<div id="optimization-problem" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Optimization problem</h3>
<p>The optimization problem depending on <span class="math inline">\(\Delta_i\)</span> is defined below.
The default optimization paramters, 5 pivot points, and a fixed initial design
is used.
The initial design is chosen such that the error constraints are
fulfilled. Early stopping for futility is applied if the effect shows
in the opponent direction to the alternative, i.e. <span class="math inline">\(c_1^f=0\)</span>.
<span class="math inline">\(c_2\)</span> is chosen close to and <span class="math inline">\(c_1^e\)</span> a little larger than the <span class="math inline">\(1-\alpha\)</span>-quantile
of the standard normal distribution. The sample sizes are selected
to fulfill the error constraints.</p>
<pre class="sourceCode r"><code class="sourceCode r">init &lt;-<span class="st"> </span><span class="kw">TwoStageDesign</span>(
    <span class="dt">n1    =</span> <span class="dv">150</span>,
    <span class="dt">c1f   =</span> <span class="dv">0</span>,
    <span class="dt">c1e   =</span> <span class="fl">2.3</span>,
    <span class="dt">n2    =</span> <span class="fl">125.0</span>,
    <span class="dt">c2    =</span> <span class="fl">2.0</span>,
    <span class="dt">order =</span> <span class="dv">5</span>
)

optimal_design &lt;-<span class="st"> </span><span class="cf">function</span>(delta) {
    <span class="kw">minimize</span>(
        <span class="kw">objective</span>(delta),
        <span class="kw">subject_to</span>(
            toer_cnstr,
            <span class="kw">ep_cnstr</span>(delta)
        ),
        <span class="dt">initial_design =</span> init
    )
}</code></pre>
<p>Compute the sequence of optimal designs</p>
<pre class="sourceCode r"><code class="sourceCode r">deltas  &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">0</span><span class="op">/</span><span class="dv">10</span>
results &lt;-<span class="st"> </span><span class="kw">lapply</span>(deltas, optimal_design)</code></pre>
</div>
<div id="test-cases-6" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Test cases</h3>
<p>Check that iteration limit was not exceeded in any case.</p>
<pre class="sourceCode r"><code class="sourceCode r">iters &lt;-<span class="st"> </span><span class="kw">sapply</span>(results, <span class="cf">function</span>(x) x<span class="op">$</span>nloptr_return<span class="op">$</span>iterations)

<span class="kw">print</span>(iters)</code></pre>
<pre><code>## [1] 1746 1857 2438 2684</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(iters <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10000</span>))</code></pre>
<p>Check type one error rate control</p>
<pre class="sourceCode r"><code class="sourceCode r">tmp     &lt;-<span class="st"> </span><span class="kw">sapply</span>(results, <span class="cf">function</span>(x) <span class="kw">sim_pr_reject</span>(x<span class="op">$</span>design, <span class="fl">.0</span>, datadist))
df_toer &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">toer =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">1</span>, ]),
    <span class="dt">se   =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">2</span>, ])
)
<span class="kw">rm</span>(tmp)

testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(df_toer<span class="op">$</span>toer <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))

df_toer</code></pre>
<pre><code>##       toer           se
## 1 0.024979 0.0001560611
## 2 0.024957 0.0001559941
## 3 0.024972 0.0001560398
## 4 0.024979 0.0001560611</code></pre>
<p>Check that expected sample size decreases with decreasing prior variance.</p>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_gte</span>(
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">1</span>]), results[[<span class="dv">1</span>]]<span class="op">$</span>design),
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">2</span>]), results[[<span class="dv">2</span>]]<span class="op">$</span>design)
)

testthat<span class="op">::</span><span class="kw">expect_gte</span>(
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">2</span>]), results[[<span class="dv">2</span>]]<span class="op">$</span>design),
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">3</span>]), results[[<span class="dv">3</span>]]<span class="op">$</span>design)
)

testthat<span class="op">::</span><span class="kw">expect_gte</span>(
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">3</span>]), results[[<span class="dv">3</span>]]<span class="op">$</span>design),
  <span class="kw">evaluate</span>(<span class="kw">objective</span>(deltas[<span class="dv">4</span>]), results[[<span class="dv">4</span>]]<span class="op">$</span>design)
)</code></pre>
</div>
<div id="plot-designs" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Plot designs</h3>
<p>Plot and assess for convergence</p>
<pre class="sourceCode r"><code class="sourceCode r">z1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.01</span>)

<span class="kw">tibble</span>(
    <span class="dt">delta  =</span> deltas, 
    <span class="dt">design =</span> <span class="kw">lapply</span>(results, <span class="cf">function</span>(x) x<span class="op">$</span>design)
) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(delta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">do</span>(
        <span class="dt">z1 =</span> z1,
        <span class="dt">n  =</span> adoptr<span class="op">::</span><span class="kw">n</span>(.<span class="op">$</span>design[[<span class="dv">1</span>]], z1),
        <span class="dt">c2 =</span> <span class="kw">c2</span>(.<span class="op">$</span>design[[<span class="dv">1</span>]], z1)
    ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(
        <span class="dt">section =</span> <span class="kw">ifelse</span>(
            <span class="kw">is.finite</span>(c2), 
            <span class="st">&quot;continuation&quot;</span>, 
            <span class="kw">ifelse</span>(c2 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="ot">Inf</span>, <span class="st">&quot;efficacy&quot;</span>, <span class="st">&quot;futility&quot;</span>)
        )
    ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">gather</span>(variable, value, n, c2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(z1, value, <span class="dt">color =</span> delta)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(section, delta))) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_color_continuous</span>(<span class="kw">bquote</span>(Delta)) <span class="op">+</span>
<span class="st">        </span><span class="kw">theme</span>(
            <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),
            <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>
        )</code></pre>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scenarioII.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="scenarioIV.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kkmann/adoptr-validation-report/edit/master/03-scenario-III.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["adoptr-validation-report.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
