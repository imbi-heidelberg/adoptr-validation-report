<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Scenario V: single-arm design, medium effect size | Validation Report for adoptr package</title>
  <meta name="description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Scenario V: single-arm design, medium effect size | Validation Report for adoptr package" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  <meta name="github-repo" content="kkmann/adoptr-validation-report" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Scenario V: single-arm design, medium effect size | Validation Report for adoptr package" />
  
  <meta name="twitter:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  

<meta name="author" content="Kevin Kunzmann &amp; Maximilian Pilz" />


<meta name="date" content="2019-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scenarioIV.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Validation Report for adoptr Package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#preliminaries"><i class="fa fa-check"></i><b>1.1</b> Preliminaries</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#scope"><i class="fa fa-check"></i><b>1.2</b> Scope</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#validating-a-local-installation-of-adoptr"><i class="fa fa-check"></i><b>1.2.1</b> Validating a local installation of adoptr</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#validation-scenarios"><i class="fa fa-check"></i><b>1.3</b> Validation Scenarios</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#scenario-i-large-effect-point-prior"><i class="fa fa-check"></i><b>1.3.1</b> <a href="scenarioI.html#scenarioI">Scenario I: Large effect, point prior</a></a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#scenario-ii-large-effect-gaussian-prior"><i class="fa fa-check"></i><b>1.3.2</b> <a href="scenarioII.html#scenarioII">Scenario II: Large effect, Gaussian prior</a></a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#scenario-iii-large-effect-uniform-prior"><i class="fa fa-check"></i><b>1.3.3</b> <a href="scenarioIII.html#scenarioIII">Scenario III: Large effect, uniform prior</a></a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#scenario-iv-smaller-effect-size-larger-trials"><i class="fa fa-check"></i><b>1.3.4</b> <a href="scenarioIV.html#scenarioIV">Scenario IV: Smaller effect size, larger trials</a></a></li>
<li class="chapter" data-level="1.3.5" data-path="index.html"><a href="index.html#scenario-v-single-arm-design-medium-effect-size"><i class="fa fa-check"></i><b>1.3.5</b> <a href="scenarioV.html#scenarioV">Scenario V: Single-arm design, medium effect size</a></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#technical-setup"><i class="fa fa-check"></i><b>1.4</b> Technical Setup</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="scenarioI.html"><a href="scenarioI.html"><i class="fa fa-check"></i><b>2</b> Scenario I: large effect, point prior</a><ul>
<li class="chapter" data-level="2.1" data-path="scenarioI.html"><a href="scenarioI.html#details"><i class="fa fa-check"></i><b>2.1</b> Details</a></li>
<li class="chapter" data-level="2.2" data-path="scenarioI.html"><a href="scenarioI.html#variantI_1"><i class="fa fa-check"></i><b>2.2</b> Variant I-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="2.2.1" data-path="scenarioI.html"><a href="scenarioI.html#objective"><i class="fa fa-check"></i><b>2.2.1</b> Objective</a></li>
<li class="chapter" data-level="2.2.2" data-path="scenarioI.html"><a href="scenarioI.html#constraints"><i class="fa fa-check"></i><b>2.2.2</b> Constraints</a></li>
<li class="chapter" data-level="2.2.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-designs"><i class="fa fa-check"></i><b>2.2.3</b> Initial Designs</a></li>
<li class="chapter" data-level="2.2.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization"><i class="fa fa-check"></i><b>2.2.4</b> Optimization</a></li>
<li class="chapter" data-level="2.2.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases"><i class="fa fa-check"></i><b>2.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="scenarioI.html"><a href="scenarioI.html#variantI_2"><i class="fa fa-check"></i><b>2.3</b> Variant I-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-1"><i class="fa fa-check"></i><b>2.3.1</b> Objective</a></li>
<li class="chapter" data-level="2.3.2" data-path="scenarioI.html"><a href="scenarioI.html#constraints-1"><i class="fa fa-check"></i><b>2.3.2</b> Constraints</a></li>
<li class="chapter" data-level="2.3.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design"><i class="fa fa-check"></i><b>2.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.3.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-1"><i class="fa fa-check"></i><b>2.3.4</b> Optimization</a></li>
<li class="chapter" data-level="2.3.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-1"><i class="fa fa-check"></i><b>2.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="scenarioI.html"><a href="scenarioI.html#variantI_3"><i class="fa fa-check"></i><b>2.4</b> Variant I-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="2.4.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-2"><i class="fa fa-check"></i><b>2.4.1</b> Objective</a></li>
<li class="chapter" data-level="2.4.2" data-path="scenarioI.html"><a href="scenarioI.html#constraints-2"><i class="fa fa-check"></i><b>2.4.2</b> Constraints</a></li>
<li class="chapter" data-level="2.4.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design-1"><i class="fa fa-check"></i><b>2.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.4.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-2"><i class="fa fa-check"></i><b>2.4.4</b> Optimization</a></li>
<li class="chapter" data-level="2.4.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-2"><i class="fa fa-check"></i><b>2.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="scenarioI.html"><a href="scenarioI.html#plot-two-stage-designs"><i class="fa fa-check"></i><b>2.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scenarioII.html"><a href="scenarioII.html"><i class="fa fa-check"></i><b>3</b> Scenario II: large effect, Gaussian prior</a><ul>
<li class="chapter" data-level="3.1" data-path="scenarioII.html"><a href="scenarioII.html#details-1"><i class="fa fa-check"></i><b>3.1</b> Details</a></li>
<li class="chapter" data-level="3.2" data-path="scenarioII.html"><a href="scenarioII.html#variantII_1"><i class="fa fa-check"></i><b>3.2</b> Variant II-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-3"><i class="fa fa-check"></i><b>3.2.1</b> Objective</a></li>
<li class="chapter" data-level="3.2.2" data-path="scenarioII.html"><a href="scenarioII.html#constraints-3"><i class="fa fa-check"></i><b>3.2.2</b> Constraints</a></li>
<li class="chapter" data-level="3.2.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-2"><i class="fa fa-check"></i><b>3.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.2.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-3"><i class="fa fa-check"></i><b>3.2.4</b> Optimization</a></li>
<li class="chapter" data-level="3.2.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-3"><i class="fa fa-check"></i><b>3.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scenarioII.html"><a href="scenarioII.html#variantII_2"><i class="fa fa-check"></i><b>3.3</b> Variant II-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-4"><i class="fa fa-check"></i><b>3.3.1</b> Objective</a></li>
<li class="chapter" data-level="3.3.2" data-path="scenarioII.html"><a href="scenarioII.html#constraints-4"><i class="fa fa-check"></i><b>3.3.2</b> Constraints</a></li>
<li class="chapter" data-level="3.3.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-3"><i class="fa fa-check"></i><b>3.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.3.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-4"><i class="fa fa-check"></i><b>3.3.4</b> Optimization</a></li>
<li class="chapter" data-level="3.3.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-4"><i class="fa fa-check"></i><b>3.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="scenarioII.html"><a href="scenarioII.html#variantII_3"><i class="fa fa-check"></i><b>3.4</b> Variant II-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="3.4.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-5"><i class="fa fa-check"></i><b>3.4.1</b> Objective</a></li>
<li class="chapter" data-level="3.4.2" data-path="scenarioII.html"><a href="scenarioII.html#constraints-5"><i class="fa fa-check"></i><b>3.4.2</b> Constraints</a></li>
<li class="chapter" data-level="3.4.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-4"><i class="fa fa-check"></i><b>3.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.4.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-5"><i class="fa fa-check"></i><b>3.4.4</b> Optimization</a></li>
<li class="chapter" data-level="3.4.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-5"><i class="fa fa-check"></i><b>3.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scenarioII.html"><a href="scenarioII.html#plot-two-stage-designs-1"><i class="fa fa-check"></i><b>3.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scenarioIII.html"><a href="scenarioIII.html"><i class="fa fa-check"></i><b>4</b> Scenario III: large effect, uniform prior</a><ul>
<li class="chapter" data-level="4.1" data-path="scenarioIII.html"><a href="scenarioIII.html#details-2"><i class="fa fa-check"></i><b>4.1</b> Details</a></li>
<li class="chapter" data-level="4.2" data-path="scenarioIII.html"><a href="scenarioIII.html#variantIII_1"><i class="fa fa-check"></i><b>4.2</b> Variant III.1: Convergence under prior concentration</a><ul>
<li class="chapter" data-level="4.2.1" data-path="scenarioIII.html"><a href="scenarioIII.html#objective-6"><i class="fa fa-check"></i><b>4.2.1</b> Objective</a></li>
<li class="chapter" data-level="4.2.2" data-path="scenarioIII.html"><a href="scenarioIII.html#constraints-6"><i class="fa fa-check"></i><b>4.2.2</b> Constraints</a></li>
<li class="chapter" data-level="4.2.3" data-path="scenarioIII.html"><a href="scenarioIII.html#optimization-problem"><i class="fa fa-check"></i><b>4.2.3</b> Optimization problem</a></li>
<li class="chapter" data-level="4.2.4" data-path="scenarioIII.html"><a href="scenarioIII.html#test-cases-6"><i class="fa fa-check"></i><b>4.2.4</b> Test cases</a></li>
<li class="chapter" data-level="4.2.5" data-path="scenarioIII.html"><a href="scenarioIII.html#plot-designs"><i class="fa fa-check"></i><b>4.2.5</b> Plot designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scenarioIV.html"><a href="scenarioIV.html"><i class="fa fa-check"></i><b>5</b> Scenario IV: smaller effect, point prior</a><ul>
<li class="chapter" data-level="5.1" data-path="scenarioIV.html"><a href="scenarioIV.html#details-3"><i class="fa fa-check"></i><b>5.1</b> Details</a></li>
<li class="chapter" data-level="5.2" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_1"><i class="fa fa-check"></i><b>5.2</b> Variant IV-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="5.2.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-7"><i class="fa fa-check"></i><b>5.2.1</b> Objective</a></li>
<li class="chapter" data-level="5.2.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constraints-7"><i class="fa fa-check"></i><b>5.2.2</b> Constraints</a></li>
<li class="chapter" data-level="5.2.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-5"><i class="fa fa-check"></i><b>5.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.2.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-6"><i class="fa fa-check"></i><b>5.2.4</b> Optimization</a></li>
<li class="chapter" data-level="5.2.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-7"><i class="fa fa-check"></i><b>5.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_2"><i class="fa fa-check"></i><b>5.3</b> Variant IV-2: Increase Power</a><ul>
<li class="chapter" data-level="5.3.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-8"><i class="fa fa-check"></i><b>5.3.1</b> Objective</a></li>
<li class="chapter" data-level="5.3.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constraints-8"><i class="fa fa-check"></i><b>5.3.2</b> Constraints</a></li>
<li class="chapter" data-level="5.3.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-6"><i class="fa fa-check"></i><b>5.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.3.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-7"><i class="fa fa-check"></i><b>5.3.4</b> Optimization</a></li>
<li class="chapter" data-level="5.3.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-8"><i class="fa fa-check"></i><b>5.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_3"><i class="fa fa-check"></i><b>5.4</b> Variant IV-3: Increase Type One Error rate</a><ul>
<li class="chapter" data-level="5.4.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-9"><i class="fa fa-check"></i><b>5.4.1</b> Objective</a></li>
<li class="chapter" data-level="5.4.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constraints-9"><i class="fa fa-check"></i><b>5.4.2</b> Constraints</a></li>
<li class="chapter" data-level="5.4.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-7"><i class="fa fa-check"></i><b>5.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.4.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-8"><i class="fa fa-check"></i><b>5.4.4</b> Optimization</a></li>
<li class="chapter" data-level="5.4.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-9"><i class="fa fa-check"></i><b>5.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="scenarioIV.html"><a href="scenarioIV.html#plot-two-stage-designs-2"><i class="fa fa-check"></i><b>5.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scenarioV.html"><a href="scenarioV.html"><i class="fa fa-check"></i><b>6</b> Scenario V: single-arm design, medium effect size</a><ul>
<li class="chapter" data-level="6.1" data-path="scenarioV.html"><a href="scenarioV.html#details-4"><i class="fa fa-check"></i><b>6.1</b> Details</a></li>
<li class="chapter" data-level="6.2" data-path="scenarioV.html"><a href="scenarioV.html#variantV_1"><i class="fa fa-check"></i><b>6.2</b> Variant V-1, sensitivity to integration order</a><ul>
<li class="chapter" data-level="6.2.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-10"><i class="fa fa-check"></i><b>6.2.1</b> Objective</a></li>
<li class="chapter" data-level="6.2.2" data-path="scenarioV.html"><a href="scenarioV.html#constraints-10"><i class="fa fa-check"></i><b>6.2.2</b> Constraints</a></li>
<li class="chapter" data-level="6.2.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-8"><i class="fa fa-check"></i><b>6.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.2.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-9"><i class="fa fa-check"></i><b>6.2.4</b> Optimization</a></li>
<li class="chapter" data-level="6.2.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-10"><i class="fa fa-check"></i><b>6.2.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="scenarioV.html"><a href="scenarioV.html#variantV_2"><i class="fa fa-check"></i><b>6.3</b> Variant V-2, utility maximization</a><ul>
<li class="chapter" data-level="6.3.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-11"><i class="fa fa-check"></i><b>6.3.1</b> Objective</a></li>
<li class="chapter" data-level="6.3.2" data-path="scenarioV.html"><a href="scenarioV.html#constraints-11"><i class="fa fa-check"></i><b>6.3.2</b> Constraints</a></li>
<li class="chapter" data-level="6.3.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-9"><i class="fa fa-check"></i><b>6.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.3.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-10"><i class="fa fa-check"></i><b>6.3.4</b> Optimization</a></li>
<li class="chapter" data-level="6.3.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-11"><i class="fa fa-check"></i><b>6.3.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="scenarioV.html"><a href="scenarioV.html#variantV_3"><i class="fa fa-check"></i><b>6.4</b> Variant V-3, n1-penalty</a><ul>
<li class="chapter" data-level="6.4.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-12"><i class="fa fa-check"></i><b>6.4.1</b> Objective</a></li>
<li class="chapter" data-level="6.4.2" data-path="scenarioV.html"><a href="scenarioV.html#constraints-12"><i class="fa fa-check"></i><b>6.4.2</b> Constraints</a></li>
<li class="chapter" data-level="6.4.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-10"><i class="fa fa-check"></i><b>6.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.4.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-11"><i class="fa fa-check"></i><b>6.4.4</b> Optimization</a></li>
<li class="chapter" data-level="6.4.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-12"><i class="fa fa-check"></i><b>6.4.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="scenarioV.html"><a href="scenarioV.html#variantV_4"><i class="fa fa-check"></i><b>6.5</b> Variant V-4, n2-penalty</a><ul>
<li class="chapter" data-level="6.5.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-13"><i class="fa fa-check"></i><b>6.5.1</b> Objective</a></li>
<li class="chapter" data-level="6.5.2" data-path="scenarioV.html"><a href="scenarioV.html#constraints-13"><i class="fa fa-check"></i><b>6.5.2</b> Constraints</a></li>
<li class="chapter" data-level="6.5.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-11"><i class="fa fa-check"></i><b>6.5.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.5.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-12"><i class="fa fa-check"></i><b>6.5.4</b> Optimization</a></li>
<li class="chapter" data-level="6.5.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-13"><i class="fa fa-check"></i><b>6.5.5</b> Test cases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation Report for <strong>adoptr</strong> package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scenarioV" class="section level1">
<h1><span class="header-section-number">6</span> Scenario V: single-arm design, medium effect size</h1>
<div id="details-4" class="section level2">
<h2><span class="header-section-number">6.1</span> Details</h2>
<p>In this scenario, again a point prior is analyzed.
The null hypothesis is <span class="math inline">\(\delta \leq 0\)</span> and we assume an alternative effect size
of <span class="math inline">\(\delta = 0.3\)</span>.
Type one error rate should be protected at 2.5% and the design’s power should
be at least 80%.
Differently than in the previous scenarios, we are assuming a single-arm
design throughout this scenario.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1"><span class="co"># data distribution and hypotheses</span></a>
<a class="sourceLine" id="cb136-2" data-line-number="2">datadist   &lt;-<span class="st"> </span><span class="kw">Normal</span>(<span class="dt">two_armed =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb136-3" data-line-number="3">H_<span class="dv">0</span>        &lt;-<span class="st"> </span><span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb136-4" data-line-number="4">prior      &lt;-<span class="st"> </span><span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb136-5" data-line-number="5"></a>
<a class="sourceLine" id="cb136-6" data-line-number="6"><span class="co"># define constraints</span></a>
<a class="sourceLine" id="cb136-7" data-line-number="7">alpha      &lt;-<span class="st"> </span><span class="fl">0.025</span></a>
<a class="sourceLine" id="cb136-8" data-line-number="8">min_power  &lt;-<span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb136-9" data-line-number="9">toer_cnstr &lt;-<span class="st"> </span><span class="kw">Power</span>(datadist, H_<span class="dv">0</span>)   <span class="op">&lt;=</span><span class="st"> </span>alpha</a>
<a class="sourceLine" id="cb136-10" data-line-number="10">pow_cnstr  &lt;-<span class="st"> </span><span class="kw">Power</span>(datadist, prior) <span class="op">&gt;=</span><span class="st"> </span>min_power</a></code></pre></div>
</div>
<div id="variantV_1" class="section level2">
<h2><span class="header-section-number">6.2</span> Variant V-1, sensitivity to integration order</h2>
<p>In this variant, the sensitivity of the optimization with respect to the
integration order is investigated.
We apply three different integration orders: 5, 8, and 11.</p>
<div id="objective-10" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Objective</h3>
<p>Expected sample size under the alternative point mass prior <span class="math inline">\(\delta = 0.3\)</span>
is minimized.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">ess &lt;-<span class="st"> </span><span class="kw">ExpectedSampleSize</span>(datadist, prior)</a></code></pre></div>
</div>
<div id="constraints-10" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Constraints</h3>
<p>No additional constraints are considered in this variant.</p>
</div>
<div id="initial-design-8" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Initial Design</h3>
<p>In order to vary the initial design, <code>rpact</code> is not used in this variant.
Instead, the following heuristical considerations are made.
A fixed design for these parameters would require
176
subjects per group. We use the half of this as initial values for the
sample sizes.
The initial stop for futility is at <span class="math inline">\(c_1^f=0\)</span>, i.e., if the effect shows
in the opponent direction to the alternative.
The starting values for the efficacy stop and for <span class="math inline">\(c_2\)</span> is the <span class="math inline">\(1-\alpha\)</span>-
quantile of the normal distribution.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">init_design &lt;-<span class="st"> </span><span class="cf">function</span>(order) {</a>
<a class="sourceLine" id="cb138-2" data-line-number="2">    <span class="kw">TwoStageDesign</span>(</a>
<a class="sourceLine" id="cb138-3" data-line-number="3">        <span class="dt">n1 =</span> <span class="kw">ceiling</span>(pwr<span class="op">::</span><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">.3</span>, </a>
<a class="sourceLine" id="cb138-4" data-line-number="4">                                     <span class="dt">sig.level =</span> <span class="fl">.025</span>, </a>
<a class="sourceLine" id="cb138-5" data-line-number="5">                                     <span class="dt">power =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb138-6" data-line-number="6">                                     <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)<span class="op">$</span>n) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb138-7" data-line-number="7">        <span class="dt">c1f =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb138-8" data-line-number="8">        <span class="dt">c1e =</span> <span class="kw">qnorm</span>( <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.025</span>),</a>
<a class="sourceLine" id="cb138-9" data-line-number="9">        <span class="dt">n2 =</span> <span class="kw">ceiling</span>(pwr<span class="op">::</span><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">.3</span>, </a>
<a class="sourceLine" id="cb138-10" data-line-number="10">                                     <span class="dt">sig.level =</span> <span class="fl">.025</span>, </a>
<a class="sourceLine" id="cb138-11" data-line-number="11">                                     <span class="dt">power =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb138-12" data-line-number="12">                                     <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)<span class="op">$</span>n) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb138-13" data-line-number="13">        <span class="dt">c2 =</span> <span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.025</span>),</a>
<a class="sourceLine" id="cb138-14" data-line-number="14">        <span class="dt">order =</span> order</a>
<a class="sourceLine" id="cb138-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb138-16" data-line-number="16">}</a></code></pre></div>
</div>
<div id="optimization-9" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Optimization</h3>
<p>The optimal design is computed for three different integration orders: 5, 8,
and 11.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1">opt_design &lt;-<span class="st"> </span><span class="cf">function</span>(order) {</a>
<a class="sourceLine" id="cb139-2" data-line-number="2">    <span class="kw">minimize</span>(</a>
<a class="sourceLine" id="cb139-3" data-line-number="3">        ess,</a>
<a class="sourceLine" id="cb139-4" data-line-number="4">        <span class="kw">subject_to</span>(</a>
<a class="sourceLine" id="cb139-5" data-line-number="5">            toer_cnstr,</a>
<a class="sourceLine" id="cb139-6" data-line-number="6">            pow_cnstr</a>
<a class="sourceLine" id="cb139-7" data-line-number="7">        ),</a>
<a class="sourceLine" id="cb139-8" data-line-number="8">        <span class="dt">initial_design =</span> <span class="kw">init_design</span>(order),</a>
<a class="sourceLine" id="cb139-9" data-line-number="9">        <span class="dt">opts =</span> opts</a>
<a class="sourceLine" id="cb139-10" data-line-number="10">    )</a>
<a class="sourceLine" id="cb139-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb139-12" data-line-number="12"></a>
<a class="sourceLine" id="cb139-13" data-line-number="13">opt &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb139-14" data-line-number="14">  <span class="dt">order  =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>),</a>
<a class="sourceLine" id="cb139-15" data-line-number="15">  <span class="dt">design =</span> <span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>), <span class="cf">function</span>(x) <span class="kw">opt_design</span>(x))</a>
<a class="sourceLine" id="cb139-16" data-line-number="16">)</a></code></pre></div>
</div>
<div id="test-cases-10" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Test cases</h3>
<p>Check if the optimization algorithm converged in all cases.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">opt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb140-3" data-line-number="3">      order, </a>
<a class="sourceLine" id="cb140-4" data-line-number="4">      <span class="dt">iterations =</span> purrr<span class="op">::</span><span class="kw">map_int</span>(opt<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb140-5" data-line-number="5">                                  <span class="op">~</span>.<span class="op">$</span>nloptr_return<span class="op">$</span>iterations) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb140-6" data-line-number="6"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-7" data-line-number="7"><span class="st">  </span>{testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>iterations <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))}</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   order iterations
##   &lt;dbl&gt;      &lt;int&gt;
## 1     5       2044
## 2     8       4660
## 3    11       8826</code></pre>
<p>Test the constraints on type one error rate and power by simulation and
compare the results to the outcome of <code>evaluate()</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">opt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb142-3" data-line-number="3">      order, </a>
<a class="sourceLine" id="cb142-4" data-line-number="4">      <span class="dt">toer      =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb142-5" data-line-number="5">                           <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb142-6" data-line-number="6">      <span class="dt">toer_sim  =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb142-7" data-line-number="7">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.0</span>, datadist)<span class="op">$</span>prob), </a>
<a class="sourceLine" id="cb142-8" data-line-number="8">      <span class="dt">power     =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb142-9" data-line-number="9">                          <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb142-10" data-line-number="10">      <span class="dt">power_sim =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb142-11" data-line-number="11">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.3</span>, datadist)<span class="op">$</span>prob) ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-12" data-line-number="12"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-13" data-line-number="13"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb142-14" data-line-number="14">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer      <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb142-15" data-line-number="15">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer_sim  <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb142-16" data-line-number="16">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power     <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb142-17" data-line-number="17">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power_sim <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol))) }</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(toer_sim, power_sim)`</code></pre>
<pre><code>## # A tibble: 3 x 5
##   order   toer toer_sim power power_sim
##   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1     5 0.0250   0.0250 0.800     0.800
## 2     8 0.0250   0.0250 0.800     0.800
## 3    11 0.0250   0.0250 0.800     0.800</code></pre>
</div>
</div>
<div id="variantV_2" class="section level2">
<h2><span class="header-section-number">6.3</span> Variant V-2, utility maximization</h2>
<div id="objective-11" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Objective</h3>
<p>In this variant, a utility function consisting of expected sample size and
power is minimized.
The parameter <span class="math inline">\(\lambda\)</span> that is describing the ratio between expected
sample size and power is varied.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1">pow &lt;-<span class="st"> </span><span class="kw">Power</span>(datadist, prior)</a>
<a class="sourceLine" id="cb145-2" data-line-number="2">ess &lt;-<span class="st"> </span><span class="kw">ExpectedSampleSize</span>(datadist, prior)</a>
<a class="sourceLine" id="cb145-3" data-line-number="3"></a>
<a class="sourceLine" id="cb145-4" data-line-number="4">obj &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {</a>
<a class="sourceLine" id="cb145-5" data-line-number="5">  <span class="kw">composite</span>({ess <span class="op">-</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>pow})</a>
<a class="sourceLine" id="cb145-6" data-line-number="6">}</a></code></pre></div>
</div>
<div id="constraints-11" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Constraints</h3>
<p>The type one error rate is controlled at 0.025 on the boundary of the
null hypothesis. Hence, the previous inequality can still be used.
There is no constraint on power any more because power is part of the
objective utility function.</p>
</div>
<div id="initial-design-9" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(5\)</span> is applied.</p>
</div>
<div id="optimization-10" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 100 and 200.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">opt_utility &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb146-2" data-line-number="2">  <span class="dt">lambda =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb146-3" data-line-number="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb146-5" data-line-number="5">    <span class="dt">design =</span> purrr<span class="op">::</span><span class="kw">map</span>(lambda, <span class="op">~</span><span class="kw">minimize</span>(</a>
<a class="sourceLine" id="cb146-6" data-line-number="6">          <span class="kw">obj</span>(.),</a>
<a class="sourceLine" id="cb146-7" data-line-number="7">          <span class="kw">subject_to</span>(</a>
<a class="sourceLine" id="cb146-8" data-line-number="8">              toer_cnstr</a>
<a class="sourceLine" id="cb146-9" data-line-number="9">          ),</a>
<a class="sourceLine" id="cb146-10" data-line-number="10">          </a>
<a class="sourceLine" id="cb146-11" data-line-number="11">          <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">5</span>), </a>
<a class="sourceLine" id="cb146-12" data-line-number="12">          <span class="dt">opts           =</span> opts)) </a>
<a class="sourceLine" id="cb146-13" data-line-number="13">)</a></code></pre></div>
</div>
<div id="test-cases-11" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Test cases</h3>
<p>Firstly, it is checked whether the maximum number of iterations was not
exceeded in both flavours.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1">opt_utility <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb147-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb147-4" data-line-number="4">      <span class="dt">iterations =</span> purrr<span class="op">::</span><span class="kw">map_int</span>(opt_utility<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb147-5" data-line-number="5">                                  <span class="op">~</span>.<span class="op">$</span>nloptr_return<span class="op">$</span>iterations) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb147-6" data-line-number="6"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-7" data-line-number="7"><span class="st">  </span>{testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>iterations <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))}</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   lambda iterations
##    &lt;dbl&gt;      &lt;int&gt;
## 1    100       3378
## 2    200       3024</code></pre>
<p>Type one error rate control is tested for both designs by simulation and by
<code>adoptr</code>’s function <code>evaluate</code>.
In addition, it is tested if the design with larger <span class="math inline">\(\lambda\)</span> (i.e.,
stronger focus on power), shows the larger overall power.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">opt_utility <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb149-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb149-4" data-line-number="4">      <span class="dt">toer      =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb149-5" data-line-number="5">                           <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb149-6" data-line-number="6">      <span class="dt">toer_sim  =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_utility<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb149-7" data-line-number="7">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.0</span>, datadist)<span class="op">$</span>prob), </a>
<a class="sourceLine" id="cb149-8" data-line-number="8">      <span class="dt">power     =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb149-9" data-line-number="9">                          <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb149-10" data-line-number="10">      <span class="dt">power_sim =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_utility<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb149-11" data-line-number="11">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.3</span>, datadist)<span class="op">$</span>prob) ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-12" data-line-number="12"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-13" data-line-number="13"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb149-14" data-line-number="14">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer     <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb149-15" data-line-number="15">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer_sim <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb149-16" data-line-number="16">  testthat<span class="op">::</span><span class="kw">expect_lte</span>(.<span class="op">$</span>power[<span class="dv">1</span>], .<span class="op">$</span>power[<span class="dv">2</span>]) }</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(toer_sim, power_sim)`</code></pre>
<pre><code>## # A tibble: 2 x 5
##   lambda   toer toer_sim power power_sim
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1    100 0.0250   0.0250 0.523     0.520
## 2    200 0.0251   0.0250 0.897     0.897</code></pre>
<p>Finally, the three designs computed so far are plotted together to allow
comparison.</p>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(x1, n, c2, CP)`</code></pre>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
</div>
<div id="variantV_3" class="section level2">
<h2><span class="header-section-number">6.4</span> Variant V-3, n1-penalty</h2>
<p>In this variant, the influence of the regularization term <code>N1()</code> is investigated.</p>
<div id="objective-12" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Objective</h3>
<p>In order to analyse the influence of <code>N1()</code>,
a mixed criterion consisting of expected sample size under the point prior
and <span class="math inline">\(N1()\)</span> is minimized.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">N1 &lt;-<span class="st"> </span><span class="kw">N1</span>()</a>
<a class="sourceLine" id="cb153-2" data-line-number="2"></a>
<a class="sourceLine" id="cb153-3" data-line-number="3">obj_n1 &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {</a>
<a class="sourceLine" id="cb153-4" data-line-number="4">  <span class="kw">composite</span>({ess <span class="op">+</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>N1})</a>
<a class="sourceLine" id="cb153-5" data-line-number="5">}</a></code></pre></div>
</div>
<div id="constraints-12" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Constraints</h3>
<p>The inequalities from variant <a href="scenarioV.html#variantV_1">V.1</a> can still be used.</p>
</div>
<div id="initial-design-10" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(5\)</span> is applied.</p>
</div>
<div id="optimization-11" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 0.05 and 0.2.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">opt_n1 &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb154-2" data-line-number="2">  <span class="dt">lambda =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb154-3" data-line-number="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb154-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb154-5" data-line-number="5">    <span class="dt">design =</span> purrr<span class="op">::</span><span class="kw">map</span>(lambda, <span class="op">~</span><span class="kw">minimize</span>(</a>
<a class="sourceLine" id="cb154-6" data-line-number="6">          <span class="kw">obj_n1</span>(.),</a>
<a class="sourceLine" id="cb154-7" data-line-number="7">          <span class="kw">subject_to</span>(</a>
<a class="sourceLine" id="cb154-8" data-line-number="8">              toer_cnstr,</a>
<a class="sourceLine" id="cb154-9" data-line-number="9">              pow_cnstr</a>
<a class="sourceLine" id="cb154-10" data-line-number="10">          ),</a>
<a class="sourceLine" id="cb154-11" data-line-number="11">          </a>
<a class="sourceLine" id="cb154-12" data-line-number="12">          <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">5</span>), </a>
<a class="sourceLine" id="cb154-13" data-line-number="13">          <span class="dt">opts           =</span> opts)) </a>
<a class="sourceLine" id="cb154-14" data-line-number="14">)</a></code></pre></div>
</div>
<div id="test-cases-12" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Test cases</h3>
<p>We start testing if the optimization algorithm converged in both cases</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1">opt_n1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb155-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb155-4" data-line-number="4">      <span class="dt">iterations =</span> purrr<span class="op">::</span><span class="kw">map_int</span>(opt_n1<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb155-5" data-line-number="5">                                  <span class="op">~</span>.<span class="op">$</span>nloptr_return<span class="op">$</span>iterations) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb155-6" data-line-number="6"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-7" data-line-number="7"><span class="st">  </span>{testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>iterations <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))}</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   lambda iterations
##    &lt;dbl&gt;      &lt;int&gt;
## 1   0.05       2222
## 2   0.2        2222</code></pre>
<p>Next, the error rate constraints on type one error rate and power are both
tested by simulation and by the <code>evaluate</code>-call.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">opt_n1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb157-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb157-4" data-line-number="4">      <span class="dt">toer      =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb157-5" data-line-number="5">                           <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb157-6" data-line-number="6">      <span class="dt">toer_sim  =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_n1<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb157-7" data-line-number="7">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.0</span>, datadist)<span class="op">$</span>prob), </a>
<a class="sourceLine" id="cb157-8" data-line-number="8">      <span class="dt">power     =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb157-9" data-line-number="9">                          <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb157-10" data-line-number="10">      <span class="dt">power_sim =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_n1<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb157-11" data-line-number="11">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.3</span>, datadist)<span class="op">$</span>prob) ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-12" data-line-number="12"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-13" data-line-number="13"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb157-14" data-line-number="14">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer      <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb157-15" data-line-number="15">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer_sim  <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb157-16" data-line-number="16">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power     <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb157-17" data-line-number="17">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power_sim <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol))) }</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(toer_sim, power_sim)`</code></pre>
<pre><code>## # A tibble: 2 x 5
##   lambda   toer toer_sim power power_sim
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1   0.05 0.0250   0.0250 0.800     0.801
## 2   0.2  0.0250   0.0250 0.800     0.800</code></pre>
<p>Since <span class="math inline">\(n_1\)</span> is penalized in both flavours that are computed in this variant,
we expect a lower <span class="math inline">\(n_1\)</span> value as larger <span class="math inline">\(\lambda\)</span>.
Furthermore, <span class="math inline">\(n_1\)</span> should be lower in both cases than in the unpenalized
situation regarded in variant <a href="scenarioV.html#variantV_1">V.1</a>.
Finally, these three designs are plotted together to allow graphical comparison.</p>
<pre><code>## # A tibble: 3 x 3
##   type                                   design       n_1
##   &lt;chr&gt;                                  &lt;list&gt;     &lt;dbl&gt;
## 1 No Penalization on n_1                 &lt;TwStgDsg&gt;    50
## 2 Penalization on n_1 with lambda = 0.05 &lt;TwStgDsg&gt;    48
## 3 Penalization on n_1 with lambda = 0.2  &lt;TwStgDsg&gt;    41</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(x1, n, c2, CP)`</code></pre>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
</div>
<div id="variantV_4" class="section level2">
<h2><span class="header-section-number">6.5</span> Variant V-4, n2-penalty</h2>
<p>Here, we alter the situation from variant <a href="scenarioV.html#variantV_3">V.3</a> by not penalizing
<span class="math inline">\(n_1\)</span>, but the average stage-two sample size <span class="math inline">\(n_2\)</span>.
This can be done by means of the function <code>AverageN2()</code>.</p>
<div id="objective-13" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Objective</h3>
<p>As in variant <a href="scenarioV.html#variantV_3">V.3</a>, a mixed criterion is minimized.
Here, it consists of expected sample size under the point prior and the
average of <span class="math inline">\(n_2\)</span>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">avn2 &lt;-<span class="st"> </span><span class="kw">AverageN2</span>()</a>
<a class="sourceLine" id="cb162-2" data-line-number="2"></a>
<a class="sourceLine" id="cb162-3" data-line-number="3">obj_n2 &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {</a>
<a class="sourceLine" id="cb162-4" data-line-number="4">  <span class="kw">composite</span>({ess <span class="op">+</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>avn2})</a>
<a class="sourceLine" id="cb162-5" data-line-number="5">}</a></code></pre></div>
</div>
<div id="constraints-13" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Constraints</h3>
<p>The inequalities from variant <a href="scenarioV.html#variantV_1">V.1</a> can still be used.</p>
</div>
<div id="initial-design-11" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(8\)</span> is applied.
However, this case requires the definition of an upper-bound for <span class="math inline">\(c_2\)</span>.
Otherwise, very small <span class="math inline">\(n_2\)</span>-values and very large <span class="math inline">\(c_2\)</span>-values would
appear close to the early-futility-stop boundary in order to
decrease the average <span class="math inline">\(n_2\)</span>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1">ub_design &lt;-<span class="st"> </span><span class="kw">get_upper_boundary_design</span>(<span class="kw">init_design</span>(<span class="dv">8</span>))</a>
<a class="sourceLine" id="cb163-2" data-line-number="2">ub_design<span class="op">@</span>c2_pivots &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">2.5</span>, <span class="dv">8</span>)</a></code></pre></div>
</div>
<div id="optimization-12" class="section level3">
<h3><span class="header-section-number">6.5.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 0.01 and 0.1.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1">opt_n2 &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb164-2" data-line-number="2">  <span class="dt">lambda =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb164-3" data-line-number="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb164-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb164-5" data-line-number="5">    <span class="dt">design =</span> purrr<span class="op">::</span><span class="kw">map</span>(lambda, <span class="op">~</span><span class="kw">minimize</span>(</a>
<a class="sourceLine" id="cb164-6" data-line-number="6">          <span class="kw">obj_n2</span>(.),</a>
<a class="sourceLine" id="cb164-7" data-line-number="7">          <span class="kw">subject_to</span>(</a>
<a class="sourceLine" id="cb164-8" data-line-number="8">              toer_cnstr,</a>
<a class="sourceLine" id="cb164-9" data-line-number="9">              pow_cnstr</a>
<a class="sourceLine" id="cb164-10" data-line-number="10">          ),</a>
<a class="sourceLine" id="cb164-11" data-line-number="11">          </a>
<a class="sourceLine" id="cb164-12" data-line-number="12">          <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">8</span>), </a>
<a class="sourceLine" id="cb164-13" data-line-number="13">          <span class="dt">upper_boundary_design =</span> ub_design,</a>
<a class="sourceLine" id="cb164-14" data-line-number="14">          <span class="dt">opts           =</span> opts)) </a>
<a class="sourceLine" id="cb164-15" data-line-number="15">)</a></code></pre></div>
</div>
<div id="test-cases-13" class="section level3">
<h3><span class="header-section-number">6.5.5</span> Test cases</h3>
<p>As first step, we check if the maximum number of iterations was not exceeded
in both cases.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1">opt_n2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb165-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb165-4" data-line-number="4">      <span class="dt">iterations =</span> purrr<span class="op">::</span><span class="kw">map_int</span>(opt_n2<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb165-5" data-line-number="5">                                  <span class="op">~</span>.<span class="op">$</span>nloptr_return<span class="op">$</span>iterations) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb165-6" data-line-number="6"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-7" data-line-number="7"><span class="st">  </span>{testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>iterations <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))}</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   lambda iterations
##    &lt;dbl&gt;      &lt;int&gt;
## 1   0.01      17059
## 2   0.1       11045</code></pre>
<p>As second step, the type one error rate and power restrictions are tested
by simulation and by calling <code>evaluate</code>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1">opt_n2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb167-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb167-3" data-line-number="3">      lambda, </a>
<a class="sourceLine" id="cb167-4" data-line-number="4">      <span class="dt">toer      =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb167-5" data-line-number="5">                           <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb167-6" data-line-number="6">      <span class="dt">toer_sim  =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_n2<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb167-7" data-line-number="7">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.0</span>, datadist)<span class="op">$</span>prob), </a>
<a class="sourceLine" id="cb167-8" data-line-number="8">      <span class="dt">power     =</span> <span class="kw">map_dbl</span>(design,</a>
<a class="sourceLine" id="cb167-9" data-line-number="9">                          <span class="op">~</span><span class="kw">evaluate</span>(<span class="kw">Power</span>(datadist, <span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)), .<span class="op">$</span>design) ),</a>
<a class="sourceLine" id="cb167-10" data-line-number="10">      <span class="dt">power_sim =</span> purrr<span class="op">::</span><span class="kw">map</span>(opt_n2<span class="op">$</span>design, </a>
<a class="sourceLine" id="cb167-11" data-line-number="11">                         <span class="op">~</span><span class="kw">sim_pr_reject</span>(.[[<span class="dv">1</span>]], <span class="fl">.3</span>, datadist)<span class="op">$</span>prob) ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb167-12" data-line-number="12"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb167-13" data-line-number="13"><span class="st">  </span>{<span class="kw">print</span>(.); .} <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb167-14" data-line-number="14">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer      <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb167-15" data-line-number="15">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>toer_sim  <span class="op">&lt;=</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb167-16" data-line-number="16">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power     <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol)))</a>
<a class="sourceLine" id="cb167-17" data-line-number="17">  testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(.<span class="op">$</span>power_sim <span class="op">&gt;=</span><span class="st"> </span>min_power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>tol))) }</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(toer_sim, power_sim)`</code></pre>
<pre><code>## # A tibble: 2 x 5
##   lambda   toer toer_sim power power_sim
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1   0.01 0.0250   0.0249 0.800     0.802
## 2   0.1  0.0250   0.0250 0.800     0.801</code></pre>
<p>Due to increasing penalization, it is assumed that the optimal design
computed in variant <a href="scenarioV.html#variantV_1">V.1</a> (no penalization) shows a larger
average <span class="math inline">\(n_2\)</span> than the optimal penalized design with <span class="math inline">\(\lambda = 0.01\)</span>
and this shows a larger average <span class="math inline">\(n_2\)</span> than the optimal design
with <span class="math inline">\(\lambda = 0.1\)</span>.
Additionally, these three designs are depicted in a joint plot.</p>
<pre><code>## # A tibble: 3 x 3
##   type                                    design     average_n2
##   &lt;chr&gt;                                   &lt;list&gt;          &lt;dbl&gt;
## 1 No Penalization on AvN2                 &lt;TwStgDsg&gt;       47.6
## 2 Penalization on AvN2 with lambda = 0.01 &lt;TwStgDsg&gt;       46.6
## 3 Penalization on AvN2 with lambda = 0.1  &lt;TwStgDsg&gt;       38.9</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(x1, n, c2, CP)`</code></pre>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scenarioIV.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"github": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kkmann/adoptr-validation-report/edit/master/05-scenario-V.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["adoptr-validation-report.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
