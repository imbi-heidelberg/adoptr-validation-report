<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6 Scenario V: Single-arm design, medium effect size | Validation Report for adoptr package</title>
  <meta name="description" content="This is an automatically generated validation report for the adoptr R package published via bookdown.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6 Scenario V: Single-arm design, medium effect size | Validation Report for adoptr package" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Scenario V: Single-arm design, medium effect size | Validation Report for adoptr package" />
  
  <meta name="twitter:description" content="This is an automatically generated validation report for the adoptr R package published via bookdown." />
  

<meta name="author" content="Kevin Kunzmann &amp; Maximilian Pilz">


<meta name="date" content="2019-04-03">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="scenarioIV.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Validation Report for adoptr Package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#concept"><i class="fa fa-check"></i><b>1.1</b> Concept</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#local-validation"><i class="fa fa-check"></i><b>1.2</b> Local validation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#brief-introdcution-to-two-stage-designs"><i class="fa fa-check"></i><b>1.3</b> Brief Introdcution to Two-Stage Designs</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#validation-strategy"><i class="fa fa-check"></i><b>1.4</b> Validation strategy</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#technical-setup"><i class="fa fa-check"></i><b>1.4.1</b> Technical Setup</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#scenario-i"><i class="fa fa-check"></i><b>1.4.2</b> <a href="https://kkmann.github.io/adoptrValidation/articles/scenario-I.html#tocnav">Scenario I</a></a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#scenario-ii"><i class="fa fa-check"></i><b>1.4.3</b> <a href="https://kkmann.github.io/adoptrValidation/articles/scenario-II.html#tocnav">Scenario II</a></a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#scenario-iii"><i class="fa fa-check"></i><b>1.4.4</b> <a href="https://kkmann.github.io/adoptrValidation/articles/scenario-III.html#tocnav">Scenario III:</a></a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#scenario-iv-smaller-effect-size-larger-trials."><i class="fa fa-check"></i><b>1.4.5</b> <a href="https://kkmann.github.io/adoptrValidation/articles/scenario-IV.html#tocnav">Scenario IV: Smaller effect size, larger trials.</a></a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#scenario-v-single-arm-design-medium-effect-size."><i class="fa fa-check"></i><b>1.4.6</b> <a href="https://kkmann.github.io/adoptrValidation/articles/scenario-V.html#tocnav">Scenario V: Single-arm design, medium effect size.</a></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="scenarioI.html"><a href="scenarioI.html"><i class="fa fa-check"></i><b>2</b> Scenario I: large effect, point prior</a><ul>
<li class="chapter" data-level="2.1" data-path="scenarioI.html"><a href="scenarioI.html#details"><i class="fa fa-check"></i><b>2.1</b> Details</a><ul>
<li class="chapter" data-level="2.1.1" data-path="scenarioI.html"><a href="scenarioI.html#data-distribution"><i class="fa fa-check"></i><b>2.1.1</b> Data distribution</a></li>
<li class="chapter" data-level="2.1.2" data-path="scenarioI.html"><a href="scenarioI.html#null-hypothesis"><i class="fa fa-check"></i><b>2.1.2</b> Null hypothesis</a></li>
<li class="chapter" data-level="2.1.3" data-path="scenarioI.html"><a href="scenarioI.html#prior-assumptions"><i class="fa fa-check"></i><b>2.1.3</b> Prior assumptions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="scenarioI.html"><a href="scenarioI.html#variantI_1"><i class="fa fa-check"></i><b>2.2</b> Variant I-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="2.2.1" data-path="scenarioI.html"><a href="scenarioI.html#objective"><i class="fa fa-check"></i><b>2.2.1</b> Objective</a></li>
<li class="chapter" data-level="2.2.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains"><i class="fa fa-check"></i><b>2.2.2</b> Constrains</a></li>
<li class="chapter" data-level="2.2.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design"><i class="fa fa-check"></i><b>2.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.2.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization"><i class="fa fa-check"></i><b>2.2.4</b> Optimization</a></li>
<li class="chapter" data-level="2.2.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases"><i class="fa fa-check"></i><b>2.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="scenarioI.html"><a href="scenarioI.html#variantI_2"><i class="fa fa-check"></i><b>2.3</b> Variant I-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-1"><i class="fa fa-check"></i><b>2.3.1</b> Objective</a></li>
<li class="chapter" data-level="2.3.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains-1"><i class="fa fa-check"></i><b>2.3.2</b> Constrains</a></li>
<li class="chapter" data-level="2.3.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design-1"><i class="fa fa-check"></i><b>2.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.3.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-1"><i class="fa fa-check"></i><b>2.3.4</b> Optimization</a></li>
<li class="chapter" data-level="2.3.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-1"><i class="fa fa-check"></i><b>2.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="scenarioI.html"><a href="scenarioI.html#variantI_3"><i class="fa fa-check"></i><b>2.4</b> Variant I-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="2.4.1" data-path="scenarioI.html"><a href="scenarioI.html#objective-2"><i class="fa fa-check"></i><b>2.4.1</b> Objective</a></li>
<li class="chapter" data-level="2.4.2" data-path="scenarioI.html"><a href="scenarioI.html#constrains-2"><i class="fa fa-check"></i><b>2.4.2</b> Constrains</a></li>
<li class="chapter" data-level="2.4.3" data-path="scenarioI.html"><a href="scenarioI.html#initial-design-2"><i class="fa fa-check"></i><b>2.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="2.4.4" data-path="scenarioI.html"><a href="scenarioI.html#optimization-2"><i class="fa fa-check"></i><b>2.4.4</b> Optimization</a></li>
<li class="chapter" data-level="2.4.5" data-path="scenarioI.html"><a href="scenarioI.html#test-cases-2"><i class="fa fa-check"></i><b>2.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="scenarioI.html"><a href="scenarioI.html#plot-two-stage-designs"><i class="fa fa-check"></i><b>2.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scenarioII.html"><a href="scenarioII.html"><i class="fa fa-check"></i><b>3</b> Scenario II: Large effect, Gaussian prior</a><ul>
<li class="chapter" data-level="3.1" data-path="scenarioII.html"><a href="scenarioII.html#details-1"><i class="fa fa-check"></i><b>3.1</b> Details</a><ul>
<li class="chapter" data-level="3.1.1" data-path="scenarioII.html"><a href="scenarioII.html#data-distribution-1"><i class="fa fa-check"></i><b>3.1.1</b> Data distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="scenarioII.html"><a href="scenarioII.html#null-hypothesis-1"><i class="fa fa-check"></i><b>3.1.2</b> Null hypothesis</a></li>
<li class="chapter" data-level="3.1.3" data-path="scenarioII.html"><a href="scenarioII.html#prior-assumptions-1"><i class="fa fa-check"></i><b>3.1.3</b> Prior assumptions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scenarioII.html"><a href="scenarioII.html#variantII_1"><i class="fa fa-check"></i><b>3.2</b> Variant II-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-3"><i class="fa fa-check"></i><b>3.2.1</b> Objective</a></li>
<li class="chapter" data-level="3.2.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-3"><i class="fa fa-check"></i><b>3.2.2</b> Constrains</a></li>
<li class="chapter" data-level="3.2.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-3"><i class="fa fa-check"></i><b>3.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.2.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-3"><i class="fa fa-check"></i><b>3.2.4</b> Optimization</a></li>
<li class="chapter" data-level="3.2.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-3"><i class="fa fa-check"></i><b>3.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scenarioII.html"><a href="scenarioII.html#variantII_2"><i class="fa fa-check"></i><b>3.3</b> Variant II-2: Minimizing Expected Sample Size under Null Hypothesis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-4"><i class="fa fa-check"></i><b>3.3.1</b> Objective</a></li>
<li class="chapter" data-level="3.3.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-4"><i class="fa fa-check"></i><b>3.3.2</b> Constrains</a></li>
<li class="chapter" data-level="3.3.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-4"><i class="fa fa-check"></i><b>3.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.3.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-4"><i class="fa fa-check"></i><b>3.3.4</b> Optimization</a></li>
<li class="chapter" data-level="3.3.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-4"><i class="fa fa-check"></i><b>3.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="scenarioII.html"><a href="scenarioII.html#variantII_3"><i class="fa fa-check"></i><b>3.4</b> Variant II-3: Conditional Power Constraint</a><ul>
<li class="chapter" data-level="3.4.1" data-path="scenarioII.html"><a href="scenarioII.html#objective-5"><i class="fa fa-check"></i><b>3.4.1</b> Objective</a></li>
<li class="chapter" data-level="3.4.2" data-path="scenarioII.html"><a href="scenarioII.html#constrains-5"><i class="fa fa-check"></i><b>3.4.2</b> Constrains</a></li>
<li class="chapter" data-level="3.4.3" data-path="scenarioII.html"><a href="scenarioII.html#initial-design-5"><i class="fa fa-check"></i><b>3.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="3.4.4" data-path="scenarioII.html"><a href="scenarioII.html#optimization-5"><i class="fa fa-check"></i><b>3.4.4</b> Optimization</a></li>
<li class="chapter" data-level="3.4.5" data-path="scenarioII.html"><a href="scenarioII.html#test-cases-5"><i class="fa fa-check"></i><b>3.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="scenarioII.html"><a href="scenarioII.html#plot-two-stage-designs-1"><i class="fa fa-check"></i><b>3.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scenarioIII.html"><a href="scenarioIII.html"><i class="fa fa-check"></i><b>4</b> Scenario III: large effect, uniform prior</a><ul>
<li class="chapter" data-level="4.1" data-path="scenarioIII.html"><a href="scenarioIII.html#details-2"><i class="fa fa-check"></i><b>4.1</b> Details</a><ul>
<li class="chapter" data-level="4.1.1" data-path="scenarioIII.html"><a href="scenarioIII.html#data-distribution-2"><i class="fa fa-check"></i><b>4.1.1</b> Data distribution</a></li>
<li class="chapter" data-level="4.1.2" data-path="scenarioIII.html"><a href="scenarioIII.html#null-hypothesis-2"><i class="fa fa-check"></i><b>4.1.2</b> Null hypothesis</a></li>
<li class="chapter" data-level="4.1.3" data-path="scenarioIII.html"><a href="scenarioIII.html#prior-assumptions-2"><i class="fa fa-check"></i><b>4.1.3</b> Prior assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="scenarioIII.html"><a href="scenarioIII.html#variantIII_1"><i class="fa fa-check"></i><b>4.2</b> Variant III.1: Convergence under prior concentration</a><ul>
<li class="chapter" data-level="4.2.1" data-path="scenarioIII.html"><a href="scenarioIII.html#objective-6"><i class="fa fa-check"></i><b>4.2.1</b> Objective</a></li>
<li class="chapter" data-level="4.2.2" data-path="scenarioIII.html"><a href="scenarioIII.html#constrains-6"><i class="fa fa-check"></i><b>4.2.2</b> Constrains</a></li>
<li class="chapter" data-level="4.2.3" data-path="scenarioIII.html"><a href="scenarioIII.html#optimization-problem"><i class="fa fa-check"></i><b>4.2.3</b> Optimization problem</a></li>
<li class="chapter" data-level="4.2.4" data-path="scenarioIII.html"><a href="scenarioIII.html#test-cases-6"><i class="fa fa-check"></i><b>4.2.4</b> Test cases</a></li>
<li class="chapter" data-level="4.2.5" data-path="scenarioIII.html"><a href="scenarioIII.html#plot-designs"><i class="fa fa-check"></i><b>4.2.5</b> Plot designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scenarioIV.html"><a href="scenarioIV.html"><i class="fa fa-check"></i><b>5</b> Scenario IV: smaller effect, point prior</a><ul>
<li class="chapter" data-level="5.1" data-path="scenarioIV.html"><a href="scenarioIV.html#details-3"><i class="fa fa-check"></i><b>5.1</b> Details</a><ul>
<li class="chapter" data-level="5.1.1" data-path="scenarioIV.html"><a href="scenarioIV.html#data-distribution-3"><i class="fa fa-check"></i><b>5.1.1</b> Data distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="scenarioIV.html"><a href="scenarioIV.html#null-hypothesis-3"><i class="fa fa-check"></i><b>5.1.2</b> Null hypothesis</a></li>
<li class="chapter" data-level="5.1.3" data-path="scenarioIV.html"><a href="scenarioIV.html#prior-assumptions-3"><i class="fa fa-check"></i><b>5.1.3</b> Prior assumptions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_1"><i class="fa fa-check"></i><b>5.2</b> Variant IV-1: Minimizing Expected Sample Size under Point Prior</a><ul>
<li class="chapter" data-level="5.2.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-7"><i class="fa fa-check"></i><b>5.2.1</b> Objective</a></li>
<li class="chapter" data-level="5.2.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-7"><i class="fa fa-check"></i><b>5.2.2</b> Constrains</a></li>
<li class="chapter" data-level="5.2.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-6"><i class="fa fa-check"></i><b>5.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.2.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-6"><i class="fa fa-check"></i><b>5.2.4</b> Optimization</a></li>
<li class="chapter" data-level="5.2.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-7"><i class="fa fa-check"></i><b>5.2.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_2"><i class="fa fa-check"></i><b>5.3</b> Variant IV-2: Increase Power</a><ul>
<li class="chapter" data-level="5.3.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-8"><i class="fa fa-check"></i><b>5.3.1</b> Objective</a></li>
<li class="chapter" data-level="5.3.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-8"><i class="fa fa-check"></i><b>5.3.2</b> Constrains</a></li>
<li class="chapter" data-level="5.3.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-7"><i class="fa fa-check"></i><b>5.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.3.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-7"><i class="fa fa-check"></i><b>5.3.4</b> Optimization</a></li>
<li class="chapter" data-level="5.3.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-8"><i class="fa fa-check"></i><b>5.3.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="scenarioIV.html"><a href="scenarioIV.html#variantIV_3"><i class="fa fa-check"></i><b>5.4</b> Variant IV-3: Increase Type One Error rate</a><ul>
<li class="chapter" data-level="5.4.1" data-path="scenarioIV.html"><a href="scenarioIV.html#objective-9"><i class="fa fa-check"></i><b>5.4.1</b> Objective</a></li>
<li class="chapter" data-level="5.4.2" data-path="scenarioIV.html"><a href="scenarioIV.html#constrains-9"><i class="fa fa-check"></i><b>5.4.2</b> Constrains</a></li>
<li class="chapter" data-level="5.4.3" data-path="scenarioIV.html"><a href="scenarioIV.html#initial-design-8"><i class="fa fa-check"></i><b>5.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="5.4.4" data-path="scenarioIV.html"><a href="scenarioIV.html#optimization-8"><i class="fa fa-check"></i><b>5.4.4</b> Optimization</a></li>
<li class="chapter" data-level="5.4.5" data-path="scenarioIV.html"><a href="scenarioIV.html#test-cases-9"><i class="fa fa-check"></i><b>5.4.5</b> Test Cases</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="scenarioIV.html"><a href="scenarioIV.html#plot-two-stage-designs-2"><i class="fa fa-check"></i><b>5.5</b> Plot Two-Stage Designs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scenarioV.html"><a href="scenarioV.html"><i class="fa fa-check"></i><b>6</b> Scenario V: Single-arm design, medium effect size</a><ul>
<li class="chapter" data-level="6.1" data-path="scenarioV.html"><a href="scenarioV.html#details-4"><i class="fa fa-check"></i><b>6.1</b> Details</a><ul>
<li class="chapter" data-level="6.1.1" data-path="scenarioV.html"><a href="scenarioV.html#data-distribution-4"><i class="fa fa-check"></i><b>6.1.1</b> Data distribution</a></li>
<li class="chapter" data-level="6.1.2" data-path="scenarioV.html"><a href="scenarioV.html#null-hypothesis-4"><i class="fa fa-check"></i><b>6.1.2</b> Null hypothesis</a></li>
<li class="chapter" data-level="6.1.3" data-path="scenarioV.html"><a href="scenarioV.html#prior-assumptions-4"><i class="fa fa-check"></i><b>6.1.3</b> Prior assumptions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="scenarioV.html"><a href="scenarioV.html#variantV_1"><i class="fa fa-check"></i><b>6.2</b> Variant V-1, sensitivity to integration order</a><ul>
<li class="chapter" data-level="6.2.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-10"><i class="fa fa-check"></i><b>6.2.1</b> Objective</a></li>
<li class="chapter" data-level="6.2.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-10"><i class="fa fa-check"></i><b>6.2.2</b> Constrains</a></li>
<li class="chapter" data-level="6.2.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-9"><i class="fa fa-check"></i><b>6.2.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.2.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-9"><i class="fa fa-check"></i><b>6.2.4</b> Optimization</a></li>
<li class="chapter" data-level="6.2.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-10"><i class="fa fa-check"></i><b>6.2.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="scenarioV.html"><a href="scenarioV.html#variantV_2"><i class="fa fa-check"></i><b>6.3</b> Variant V-2, utility maximization</a><ul>
<li class="chapter" data-level="6.3.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-11"><i class="fa fa-check"></i><b>6.3.1</b> Objective</a></li>
<li class="chapter" data-level="6.3.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-11"><i class="fa fa-check"></i><b>6.3.2</b> Constrains</a></li>
<li class="chapter" data-level="6.3.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-10"><i class="fa fa-check"></i><b>6.3.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.3.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-10"><i class="fa fa-check"></i><b>6.3.4</b> Optimization</a></li>
<li class="chapter" data-level="6.3.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-11"><i class="fa fa-check"></i><b>6.3.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="scenarioV.html"><a href="scenarioV.html#variantV_3"><i class="fa fa-check"></i><b>6.4</b> Variant V-3, n1-penalty</a><ul>
<li class="chapter" data-level="6.4.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-12"><i class="fa fa-check"></i><b>6.4.1</b> Objective</a></li>
<li class="chapter" data-level="6.4.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-12"><i class="fa fa-check"></i><b>6.4.2</b> Constrains</a></li>
<li class="chapter" data-level="6.4.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-11"><i class="fa fa-check"></i><b>6.4.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.4.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-11"><i class="fa fa-check"></i><b>6.4.4</b> Optimization</a></li>
<li class="chapter" data-level="6.4.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-12"><i class="fa fa-check"></i><b>6.4.5</b> Test cases</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="scenarioV.html"><a href="scenarioV.html#variantV_4"><i class="fa fa-check"></i><b>6.5</b> Variant V-4, n2-penalty</a><ul>
<li class="chapter" data-level="6.5.1" data-path="scenarioV.html"><a href="scenarioV.html#objective-13"><i class="fa fa-check"></i><b>6.5.1</b> Objective</a></li>
<li class="chapter" data-level="6.5.2" data-path="scenarioV.html"><a href="scenarioV.html#constrains-13"><i class="fa fa-check"></i><b>6.5.2</b> Constrains</a></li>
<li class="chapter" data-level="6.5.3" data-path="scenarioV.html"><a href="scenarioV.html#initial-design-12"><i class="fa fa-check"></i><b>6.5.3</b> Initial Design</a></li>
<li class="chapter" data-level="6.5.4" data-path="scenarioV.html"><a href="scenarioV.html#optimization-12"><i class="fa fa-check"></i><b>6.5.4</b> Optimization</a></li>
<li class="chapter" data-level="6.5.5" data-path="scenarioV.html"><a href="scenarioV.html#test-cases-13"><i class="fa fa-check"></i><b>6.5.5</b> Test cases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation Report for <strong>adoptr</strong> package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scenarioV" class="section level1">
<h1><span class="header-section-number">6</span> Scenario V: Single-arm design, medium effect size</h1>
<div id="details-4" class="section level2">
<h2><span class="header-section-number">6.1</span> Details</h2>
<p>In this scenario an alternative effect size of <span class="math inline">\(\delta = 0.3\)</span> with
point prior distribution is investigated.
This smaller effect size should lead to larger sample sizes than
in scenario I.
The null hypothesis is <span class="math inline">\(\delta \leq 0\)</span>.
Currently, <code>adoptr</code> only supports normal distributed data what is widely spread
in the development of adaptive designs.</p>
<div id="data-distribution-4" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Data distribution</h3>
<p>One-armed trial with normally distributed test statistic</p>
<pre class="sourceCode r"><code class="sourceCode r">datadist &lt;-<span class="st"> </span><span class="kw">Normal</span>(<span class="dt">two_armed =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="null-hypothesis-4" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Null hypothesis</h3>
<p>The null hypothesis is <span class="math inline">\(\mathcal{H}_0:\delta \leq 0\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">H_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">PointMassPrior</span>(.<span class="dv">0</span>, <span class="dv">1</span>)</code></pre>
</div>
<div id="prior-assumptions-4" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Prior assumptions</h3>
<p>A point mass prior with probability mass on <span class="math inline">\(\delta = 0.3\)</span> is assumed.</p>
<pre class="sourceCode r"><code class="sourceCode r">prior &lt;-<span class="st"> </span><span class="kw">PointMassPrior</span>(.<span class="dv">3</span>, <span class="dv">1</span>)</code></pre>
</div>
</div>
<div id="variantV_1" class="section level2">
<h2><span class="header-section-number">6.2</span> Variant V-1, sensitivity to integration order</h2>
<div id="objective-10" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Objective</h3>
<p>Expected sample size under the respective prior is minimized, i.e.,
<span class="math inline">\(\boldsymbol{E}\big[n(\mathcal{D})\big]\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">ess &lt;-<span class="st"> </span><span class="kw">expected</span>(<span class="kw">ConditionalSampleSize</span>(datadist, prior))</code></pre>
</div>
<div id="constrains-10" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Constrains</h3>
<p>The type one error rate is controlled at <span class="math inline">\(0.025\)</span> on the boundary of the
null hypothesis.</p>
<pre class="sourceCode r"><code class="sourceCode r">toer_cnstr &lt;-<span class="st"> </span><span class="kw">expected</span>(<span class="kw">ConditionalPower</span>(datadist, H_<span class="dv">0</span>)) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.025</span></code></pre>
<p>Power must be larger than <span class="math inline">\(0.8\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">pow_cnstr &lt;-<span class="st"> </span><span class="kw">expected</span>(<span class="kw">ConditionalPower</span>(datadist, prior)) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.8</span></code></pre>
</div>
<div id="initial-design-9" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Initial Design</h3>
<p>A fixed design for these parameters would require
176
subjects per group. We use the half of this as initial values for the
sample sizes.
The initial stop for futility is at <span class="math inline">\(c_1^f=0\)</span>, i.e., if the effect shows
in the opponent direction to the alternative.
The starting values for the efficacy stop and for <span class="math inline">\(c_2\)</span> is the <span class="math inline">\(1-\alpha\)</span>-
quantile of the normal distribution.</p>
<pre class="sourceCode r"><code class="sourceCode r">init_design &lt;-<span class="st"> </span><span class="cf">function</span>(order) {
    <span class="kw">TwoStageDesign</span>(
        <span class="dt">n1 =</span> <span class="kw">ceiling</span>(pwr<span class="op">::</span><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">.3</span>, <span class="dt">sig.level =</span> <span class="fl">.025</span>, <span class="dt">power =</span> <span class="fl">.8</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)<span class="op">$</span>n) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,
        <span class="dt">c1f =</span> <span class="dv">0</span>,
        <span class="dt">c1e =</span> <span class="kw">qnorm</span>( <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.025</span>),
        <span class="dt">n2 =</span> <span class="kw">ceiling</span>(pwr<span class="op">::</span><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">.3</span>, <span class="dt">sig.level =</span> <span class="fl">.025</span>, <span class="dt">power =</span> <span class="fl">.8</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)<span class="op">$</span>n) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,
        <span class="dt">c2 =</span> <span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.025</span>),
        <span class="dt">order =</span> order
)
}</code></pre>
</div>
<div id="optimization-9" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Optimization</h3>
<p>The optimal design is computed for three different integration orders: 5, 8,
and 11.</p>
<pre class="sourceCode r"><code class="sourceCode r">opt_design &lt;-<span class="st"> </span><span class="cf">function</span>(order) {
    <span class="kw">minimize</span>(
        
        ess,
        
        <span class="kw">subject_to</span>(
            
            toer_cnstr,
            pow_cnstr
            
        ),
        
        <span class="dt">initial_design =</span> <span class="kw">init_design</span>(order),
        
        <span class="dt">opts =</span> opts
        
)
}

opt1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>), <span class="cf">function</span>(x) <span class="kw">opt_design</span>(x))</code></pre>
<pre><code>## Warning in minimize(ess, subject_to(toer_cnstr, pow_cnstr), initial_design
## = init_design(order), : initial design is infeasible!

## Warning in minimize(ess, subject_to(toer_cnstr, pow_cnstr), initial_design
## = init_design(order), : initial design is infeasible!

## Warning in minimize(ess, subject_to(toer_cnstr, pow_cnstr), initial_design
## = init_design(order), : initial design is infeasible!</code></pre>
</div>
<div id="test-cases-10" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Test cases</h3>
<p>Check if the optimization algorithm converged in all cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">iters &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt1, <span class="cf">function</span>(x) x<span class="op">$</span>nloptr_return<span class="op">$</span>iterations)

<span class="kw">print</span>(iters)</code></pre>
<pre><code>## [1] 2044 4660 8826</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(iters <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))</code></pre>
<p>Check type one error rate control.
Due to numerical issues we allow a realtive error of <span class="math inline">\(1\%\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_toer &lt;-<span class="st"> </span><span class="cf">function</span>(design) {
    simdata &lt;-<span class="st"> </span><span class="kw">simulate</span>(
        design,
        <span class="dt">nsim  =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, 
        <span class="dt">dist  =</span> datadist, 
        <span class="dt">theta =</span>   <span class="fl">.0</span>,
        <span class="dt">seed  =</span> <span class="dv">42</span>
    )
    <span class="kw">return</span>(<span class="kw">list</span>(
        <span class="dt">toer =</span> <span class="kw">mean</span>(simdata<span class="op">$</span>reject), 
        <span class="dt">se   =</span> <span class="kw">sd</span>(simdata<span class="op">$</span>reject) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(simdata))
    ))
}

tmp     &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt1, <span class="cf">function</span>(x) <span class="kw">sim_toer</span>(x<span class="op">$</span>design))
df_toer &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">toer =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">1</span>, ]),
    <span class="dt">se   =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">2</span>, ])
)
<span class="kw">rm</span>(tmp)

testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(df_toer<span class="op">$</span>toer <span class="op">&lt;</span><span class="st"> </span><span class="fl">.025</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.01</span>))

df_toer</code></pre>
<pre><code>##       toer           se
## 1 0.024978 0.0001560581
## 2 0.024955 0.0001559881
## 3 0.024951 0.0001559759</code></pre>
<p>Check the power constraint.
For numerical reasons we allow a realtive error of <span class="math inline">\(1\%\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_pow &lt;-<span class="st"> </span><span class="cf">function</span>(design) {
    simdata &lt;-<span class="st"> </span><span class="kw">simulate</span>(
        design,
        <span class="dt">nsim  =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, 
        <span class="dt">dist  =</span> datadist, 
        <span class="dt">theta =</span>   <span class="fl">.3</span>,
        <span class="dt">seed  =</span> <span class="dv">42</span>
    )
    <span class="kw">return</span>(<span class="kw">list</span>(
        <span class="dt">pow =</span> <span class="kw">mean</span>(simdata<span class="op">$</span>reject), 
        <span class="dt">se  =</span> <span class="kw">sd</span>(simdata<span class="op">$</span>reject) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(simdata))
    ))
}

tmp     &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt1, <span class="cf">function</span>(x) <span class="kw">sim_pow</span>(x<span class="op">$</span>design))
df_pow &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">power =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">1</span>, ]),
    <span class="dt">se    =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">2</span>, ])
)
<span class="kw">rm</span>(tmp)

testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(df_pow<span class="op">$</span>pow <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.01</span>)))

df_pow</code></pre>
<pre><code>##      power           se
## 1 0.799817 0.0004001374
## 2 0.799668 0.0004002490
## 3 0.799646 0.0004002655</code></pre>
<p>Check expected sample size under the prior.</p>
<pre class="sourceCode r"><code class="sourceCode r">sim_ess &lt;-<span class="st"> </span><span class="cf">function</span>(design) {
    simdata &lt;-<span class="st"> </span><span class="kw">simulate</span>(
        design,
        <span class="dt">nsim  =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, 
        <span class="dt">dist  =</span> datadist, 
        <span class="dt">theta =</span>   <span class="fl">.3</span>,
        <span class="dt">seed  =</span> <span class="dv">42</span>
    )
    <span class="kw">return</span>(<span class="kw">list</span>(
        <span class="dt">n  =</span> <span class="kw">mean</span>(simdata<span class="op">$</span>n1 <span class="op">+</span><span class="st"> </span>simdata<span class="op">$</span>n2), 
        <span class="dt">se =</span> <span class="kw">sd</span>(simdata<span class="op">$</span>n1 <span class="op">+</span><span class="st"> </span>simdata<span class="op">$</span>n2) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(simdata))
    ))
}

tmp     &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt1, <span class="cf">function</span>(x) <span class="kw">sim_ess</span>(x<span class="op">$</span>design))
df_ess &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">n  =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">1</span>, ]),
    <span class="dt">se =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">2</span>, ])
)
<span class="kw">rm</span>(tmp)

df_ess</code></pre>
<pre><code>##          n         se
## 1 70.98114 0.02437353
## 2 70.99017 0.02438000
## 3 70.99167 0.02437997</code></pre>
</div>
</div>
<div id="variantV_2" class="section level2">
<h2><span class="header-section-number">6.3</span> Variant V-2, utility maximization</h2>
<div id="objective-11" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Objective</h3>
<p>In this case, a utility function consisting of expected sample size and
power is minimized.</p>
<pre class="sourceCode r"><code class="sourceCode r">pow &lt;-<span class="st"> </span><span class="kw">expected</span>(<span class="kw">ConditionalPower</span>(datadist, prior))

obj &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {
    <span class="kw">expected</span>(<span class="kw">ConditionalSampleSize</span>(datadist, prior)) <span class="op">+</span><span class="st">  </span>
<span class="st">        </span>(<span class="op">-</span>lambda) <span class="op">*</span><span class="st"> </span>pow
}</code></pre>
</div>
<div id="constrains-11" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Constrains</h3>
<p>The type one error rate is controlled at <span class="math inline">\(0.025\)</span> on the boundary of the
null hypothesis. Hence, the previous inequality can still be used.</p>
</div>
<div id="initial-design-10" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(5\)</span> is applied.</p>
</div>
<div id="optimization-10" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 100 and 200.</p>
<pre class="sourceCode r"><code class="sourceCode r">opt2_design &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {

    <span class="kw">minimize</span>(
        
        <span class="kw">obj</span>(lambda),
        
        <span class="kw">subject_to</span>(
            
            toer_cnstr

        ),
        
        <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">5</span>),
        
        <span class="dt">opts =</span> opts
        
)
}

opt2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="cf">function</span>(x) <span class="kw">opt2_design</span>(x))</code></pre>
<pre><code>## Warning in minimize(obj(lambda), subject_to(toer_cnstr), initial_design =
## init_design(5), : initial design is infeasible!

## Warning in minimize(obj(lambda), subject_to(toer_cnstr), initial_design =
## init_design(5), : initial design is infeasible!</code></pre>
</div>
<div id="test-cases-11" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Test cases</h3>
<p>Check if the optimization algorithm converged in all cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">iters &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt2, <span class="cf">function</span>(x) x<span class="op">$</span>nloptr_return<span class="op">$</span>iterations)

<span class="kw">print</span>(iters)</code></pre>
<pre><code>## [1] 3378 3024</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(iters <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))</code></pre>
<p>Check type one error rate control for both designs via simulation.
Due to numerical issues we allow a realtive error of <span class="math inline">\(1\%\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">tmp     &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt2, <span class="cf">function</span>(x) <span class="kw">sim_toer</span>(x<span class="op">$</span>design))
df_toer &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">toer =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">1</span>, ]),
    <span class="dt">se   =</span> <span class="kw">as.numeric</span>(tmp[<span class="dv">2</span>, ])
)
<span class="kw">rm</span>(tmp)

testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(df_toer<span class="op">$</span>toer <span class="op">&lt;</span><span class="st"> </span><span class="fl">.025</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.01</span>))

df_toer</code></pre>
<pre><code>##       toer           se
## 1 0.025022 0.0001561919
## 2 0.024971 0.0001560368</code></pre>
<p>Check if the power of the design with higher <span class="math inline">\(\lambda\)</span> is larger.</p>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_gte</span>(
    <span class="kw">evaluate</span>(pow, opt2[[<span class="dv">2</span>]]<span class="op">$</span>design),
    <span class="kw">evaluate</span>(pow, opt2[[<span class="dv">1</span>]]<span class="op">$</span>design)
)</code></pre>
<p>Finally the three designs computed so far are plotted together to allow
comparison.</p>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="variantV_3" class="section level2">
<h2><span class="header-section-number">6.4</span> Variant V-3, n1-penalty</h2>
<p>In this case, the influence of the regularization term <code>N1()</code> is investigated.</p>
<div id="objective-12" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Objective</h3>
<p>In this case, a mixed criterion consisting of expected sample size and
<span class="math inline">\(n_1\)</span> is minimized.</p>
<pre class="sourceCode r"><code class="sourceCode r">N1 &lt;-<span class="st"> </span><span class="kw">N1</span>()

obj3 &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {
    ess <span class="op">+</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>N1
}</code></pre>
</div>
<div id="constrains-12" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Constrains</h3>
<p>The inequalities from variant V.1 can still be used.</p>
</div>
<div id="initial-design-11" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(5\)</span> is applied.</p>
</div>
<div id="optimization-11" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 0.05 and 0.2.</p>
<pre class="sourceCode r"><code class="sourceCode r">opt3_design &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {

    <span class="kw">minimize</span>(
        
        <span class="kw">obj3</span>(lambda),
        
        <span class="kw">subject_to</span>(
            
            toer_cnstr,
            pow_cnstr

        ),
        
        <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">5</span>),
        
        <span class="dt">opts =</span> opts
        
)
}

opt3 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.2</span>), <span class="cf">function</span>(x) <span class="kw">opt3_design</span>(x))</code></pre>
<pre><code>## Warning in minimize(obj3(lambda), subject_to(toer_cnstr, pow_cnstr),
## initial_design = init_design(5), : initial design is infeasible!

## Warning in minimize(obj3(lambda), subject_to(toer_cnstr, pow_cnstr),
## initial_design = init_design(5), : initial design is infeasible!</code></pre>
</div>
<div id="test-cases-12" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Test cases</h3>
<p>Check if the optimization algorithm converged in all cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">iters &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt3, <span class="cf">function</span>(x) x<span class="op">$</span>nloptr_return<span class="op">$</span>iterations)

<span class="kw">print</span>(iters)</code></pre>
<pre><code>## [1] 2222 2222</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(iters <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))</code></pre>
<p>Check if the n1 regularizer of the design with higher <span class="math inline">\(\lambda\)</span> is lower.</p>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_lte</span>(
    <span class="kw">evaluate</span>(N1, opt3[[<span class="dv">2</span>]]<span class="op">$</span>design),
    <span class="kw">evaluate</span>(N1, opt3[[<span class="dv">1</span>]]<span class="op">$</span>design)
)


testthat<span class="op">::</span><span class="kw">expect_lte</span>(
    <span class="kw">evaluate</span>(N1, opt3[[<span class="dv">1</span>]]<span class="op">$</span>design),
    <span class="kw">evaluate</span>(N1, opt1[[<span class="dv">1</span>]]<span class="op">$</span>design)
)</code></pre>
<p>Finally the three designs computed so far are plotted together to allow
comparison.</p>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
</div>
</div>
<div id="variantV_4" class="section level2">
<h2><span class="header-section-number">6.5</span> Variant V-4, n2-penalty</h2>
<p>In this case the average over <span class="math inline">\(n_2\)</span> is penalized by the predefined score
<code>AverageN2</code>.</p>
<div id="objective-13" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Objective</h3>
<p>In this case, a mixed criterion consisting of expected sample size and
average of <span class="math inline">\(n_2\)</span> is minimized.</p>
<pre class="sourceCode r"><code class="sourceCode r">avn2 &lt;-<span class="st"> </span><span class="kw">AverageN2</span>()

obj4 &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {
    ess <span class="op">+</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>avn2
}</code></pre>
</div>
<div id="constrains-13" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Constrains</h3>
<p>The inequalities from variant V.1 can still be used.</p>
</div>
<div id="initial-design-12" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Initial Design</h3>
<p>The previous initial design with order <span class="math inline">\(5\)</span> is applied.</p>
</div>
<div id="optimization-12" class="section level3">
<h3><span class="header-section-number">6.5.4</span> Optimization</h3>
<p>The optimal design is computed for two values of <span class="math inline">\(\lambda\)</span>: 0.01 and 0.1.</p>
<pre class="sourceCode r"><code class="sourceCode r">opt4_design &lt;-<span class="st"> </span><span class="cf">function</span>(lambda) {

    <span class="kw">minimize</span>(
        
        <span class="kw">obj4</span>(lambda),
        
        <span class="kw">subject_to</span>(
            
            toer_cnstr,
            pow_cnstr

        ),
        
        <span class="dt">initial_design =</span> <span class="kw">init_design</span>(<span class="dv">5</span>),
        <span class="dt">upper_boundary_design =</span> <span class="kw">get_upper_boundary_design</span>(<span class="kw">init_design</span>(<span class="dv">5</span>), <span class="dt">c2_buffer=</span><span class="dv">3</span>),
        
        <span class="dt">opts =</span> opts
        
)
}

opt4 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(.<span class="dv">01</span>, <span class="fl">.1</span>), <span class="cf">function</span>(x) <span class="kw">opt4_design</span>(x))</code></pre>
<pre><code>## Warning in minimize(obj4(lambda), subject_to(toer_cnstr, pow_cnstr),
## initial_design = init_design(5), : initial design is infeasible!

## Warning in minimize(obj4(lambda), subject_to(toer_cnstr, pow_cnstr),
## initial_design = init_design(5), : initial design is infeasible!</code></pre>
</div>
<div id="test-cases-13" class="section level3">
<h3><span class="header-section-number">6.5.5</span> Test cases</h3>
<p>Check if the optimization algorithm converged in all cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">iters &lt;-<span class="st"> </span><span class="kw">sapply</span>(opt4, <span class="cf">function</span>(x) x<span class="op">$</span>nloptr_return<span class="op">$</span>iterations)

<span class="kw">print</span>(iters)</code></pre>
<pre><code>## [1] 1952 1530</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_true</span>(<span class="kw">all</span>(iters <span class="op">&lt;</span><span class="st"> </span>opts<span class="op">$</span>maxeval))</code></pre>
<p>Check if the average <span class="math inline">\(n_2\)</span> regularizer of the design with
higher <span class="math inline">\(\lambda\)</span> is lower.</p>
<pre class="sourceCode r"><code class="sourceCode r">testthat<span class="op">::</span><span class="kw">expect_lte</span>(
    <span class="kw">evaluate</span>(avn2, opt4[[<span class="dv">2</span>]]<span class="op">$</span>design),
    <span class="kw">evaluate</span>(avn2, opt4[[<span class="dv">1</span>]]<span class="op">$</span>design)
)


testthat<span class="op">::</span><span class="kw">expect_lte</span>(
    <span class="kw">evaluate</span>(avn2, opt4[[<span class="dv">1</span>]]<span class="op">$</span>design),
    <span class="kw">evaluate</span>(avn2, opt1[[<span class="dv">1</span>]]<span class="op">$</span>design)
)</code></pre>
<p>Finally the three designs computed so far are plotted together to allow
comparison.</p>
<p><img src="adoptr-validation-report_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scenarioIV.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kkmann/adoptr-validation-report/edit/master/05-scenario-V.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["adoptr-validation-report.pdf"],
"toc": {
"collapse": "section"
},
"github-repo": "kkmann/adoptr-validation-report"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
